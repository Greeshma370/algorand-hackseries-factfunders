import{r as Tr,c as Cr,g as ir}from"./index-BvQbX75z.js";import{d as Nr,c as de}from"./format-CIF1Y4UC.js";var xe={},V={};Object.defineProperty(V,"__esModule",{value:!0});var nr=V.getLocalStorage=V.getLocalStorageOrThrow=V.getCrypto=V.getCryptoOrThrow=or=V.getLocation=V.getLocationOrThrow=sr=V.getNavigator=V.getNavigatorOrThrow=V.getDocument=V.getDocumentOrThrow=V.getFromWindowOrThrow=V.getFromWindow=void 0;function oe(r){let t;return typeof window<"u"&&typeof window[r]<"u"&&(t=window[r]),t}V.getFromWindow=oe;function ue(r){const t=oe(r);if(!t)throw new Error(`${r} is not defined in Window`);return t}V.getFromWindowOrThrow=ue;function Fr(){return ue("document")}V.getDocumentOrThrow=Fr;function xr(){return oe("document")}V.getDocument=xr;function qr(){return ue("navigator")}V.getNavigatorOrThrow=qr;function Pr(){return oe("navigator")}var sr=V.getNavigator=Pr;function Lr(){return ue("location")}V.getLocationOrThrow=Lr;function Wr(){return oe("location")}var or=V.getLocation=Wr;function Ur(){return ue("crypto")}V.getCryptoOrThrow=Ur;function Dr(){return oe("crypto")}V.getCrypto=Dr;function jr(){return ue("localStorage")}V.getLocalStorageOrThrow=jr;function Hr(){return oe("localStorage")}nr=V.getLocalStorage=Hr;Object.defineProperty(xe,"__esModule",{value:!0});var ar=xe.getWindowMetadata=void 0;const ze=V;function zr(){let r,t;try{r=ze.getDocumentOrThrow(),t=ze.getLocationOrThrow()}catch{return null}function i(){const H=r.getElementsByTagName("link"),Ot=[];for(let At=0;At<H.length;At++){const _t=H[At],Tt=_t.getAttribute("rel");if(Tt&&Tt.toLowerCase().indexOf("icon")>-1){const y=_t.getAttribute("href");if(y)if(y.toLowerCase().indexOf("https:")===-1&&y.toLowerCase().indexOf("http:")===-1&&y.indexOf("//")!==0){let S=t.protocol+"//"+t.host;if(y.indexOf("/")===0)S+=y;else{const B=t.pathname.split("/");B.pop();const O=B.join("/");S+=O+"/"+y}Ot.push(S)}else if(y.indexOf("//")===0){const S=t.protocol+y;Ot.push(S)}else Ot.push(y)}}return Ot}function c(...H){const Ot=r.getElementsByTagName("meta");for(let At=0;At<Ot.length;At++){const _t=Ot[At],Tt=["itemprop","property","name"].map(y=>_t.getAttribute(y)).filter(y=>y?H.includes(y):!1);if(Tt.length&&Tt){const y=_t.getAttribute("content");if(y)return y}}return""}function v(){let H=c("name","og:site_name","og:title","twitter:title");return H||(H=r.title),H}function f(){return c("description","og:description","twitter:description","keywords")}const N=v(),W=f(),C=t.origin,D=i();return{description:W,url:C,icons:D,name:N}}ar=xe.getWindowMetadata=zr;var Vr=function(){for(var r=0,t=0,i=arguments.length;t<i;t++)r+=arguments[t].length;for(var c=Array(r),v=0,t=0;t<i;t++)for(var f=arguments[t],N=0,W=f.length;N<W;N++,v++)c[v]=f[N];return c},$r=function(){function r(t,i,c){this.name=t,this.version=i,this.os=c,this.type="browser"}return r}(),Kr=function(){function r(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return r}(),Jr=function(){function r(t,i,c,v){this.name=t,this.version=i,this.os=c,this.bot=v,this.type="bot-device"}return r}(),Gr=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),Zr=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),Qr=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Xr=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ve=3,Yr=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",Qr]],$e=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ti(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Zr:typeof navigator<"u"?ri(navigator.userAgent):ni()}function ei(r){return r!==""&&Yr.reduce(function(t,i){var c=i[0],v=i[1];if(t)return t;var f=v.exec(r);return!!f&&[c,f]},!1)}function ri(r){var t=ei(r);if(!t)return null;var i=t[0],c=t[1];if(i==="searchbot")return new Gr;var v=c[1]&&c[1].split(/[._]/).slice(0,3);v?v.length<Ve&&(v=Vr(v,si(Ve-v.length))):v=[];var f=v.join("."),N=ii(r),W=Xr.exec(r);return W&&W[1]?new Jr(i,f,N,W[1]):new $r(i,f,N)}function ii(r){for(var t=0,i=$e.length;t<i;t++){var c=$e[t],v=c[0],f=c[1],N=f.exec(r);if(N)return v}return null}function ni(){var r=typeof process<"u"&&process.version;return r?new Kr(process.version.slice(1)):null}function si(r){for(var t=[],i=0;i<r;i++)t.push("0");return t}function qe(r){return ti()}function Pe(){const r=qe();return r&&r.os?r.os:void 0}function oi(){const r=Pe();return r?r.toLowerCase().includes("android"):!1}function ai(){const r=Pe();return r?r.toLowerCase().includes("ios")||r.toLowerCase().includes("mac")&&navigator.maxTouchPoints>1:!1}function hi(){return Pe()?oi()||ai():!1}function ci(){const r=qe();return r&&r.name?r.name.toLowerCase()==="node":!1}function ui(){return!ci()&&!!li()}const li=sr,fi=or,Le=nr;function Ke(){return ar()}function di(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function pi(r){return typeof r=="string"?r:JSON.stringify(r)}const gi=di,mi=pi;function vi(r,t){const i=mi(t),c=Le();c&&c.setItem(r,i)}function hr(r){let t=null,i=null;const c=Le();return c&&(i=c.getItem(r)),t=i&&gi(i),t}function cr(r){const t=Le();t&&t.removeItem(r)}const Je="WALLETCONNECT_DEEPLINK_CHOICE",wi=["session_request","session_update","exchange_key","connect","disconnect","display_uri","modal_closed","transport_open","transport_close","transport_error"],ur=["eth_sendTransaction","eth_signTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v2","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"];var We={exports:{}};We.exports;(function(r){(function(t,i){function c(p,e){if(!p)throw new Error(e||"Assertion failed")}function v(p,e){p.super_=e;var s=function(){};s.prototype=e.prototype,p.prototype=new s,p.prototype.constructor=p}function f(p,e,s){if(f.isBN(p))return p;this.negative=0,this.words=null,this.length=0,this.red=null,p!==null&&((e==="le"||e==="be")&&(s=e,e=10),this._init(p||0,e||10,s||"be"))}typeof t=="object"?t.exports=f:i.BN=f,f.BN=f,f.wordSize=26;var N;try{N=Tr.Buffer}catch{}f.isBN=function(e){return e instanceof f?!0:e!==null&&typeof e=="object"&&e.constructor.wordSize===f.wordSize&&Array.isArray(e.words)},f.max=function(e,s){return e.cmp(s)>0?e:s},f.min=function(e,s){return e.cmp(s)<0?e:s},f.prototype._init=function(e,s,a){if(typeof e=="number")return this._initNumber(e,s,a);if(typeof e=="object")return this._initArray(e,s,a);s==="hex"&&(s=16),c(s===(s|0)&&s>=2&&s<=36),e=e.toString().replace(/\s+/g,"");var h=0;e[0]==="-"&&h++,s===16?this._parseHex(e,h):this._parseBase(e,s,h),e[0]==="-"&&(this.negative=1),this.strip(),a==="le"&&this._initArray(this.toArray(),s,a)},f.prototype._initNumber=function(e,s,a){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[e&67108863],this.length=1):e<4503599627370496?(this.words=[e&67108863,e/67108864&67108863],this.length=2):(c(e<9007199254740992),this.words=[e&67108863,e/67108864&67108863,1],this.length=3),a==="le"&&this._initArray(this.toArray(),s,a)},f.prototype._initArray=function(e,s,a){if(c(typeof e.length=="number"),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var h=0;h<this.length;h++)this.words[h]=0;var d,g,m=0;if(a==="be")for(h=e.length-1,d=0;h>=0;h-=3)g=e[h]|e[h-1]<<8|e[h-2]<<16,this.words[d]|=g<<m&67108863,this.words[d+1]=g>>>26-m&67108863,m+=24,m>=26&&(m-=26,d++);else if(a==="le")for(h=0,d=0;h<e.length;h+=3)g=e[h]|e[h+1]<<8|e[h+2]<<16,this.words[d]|=g<<m&67108863,this.words[d+1]=g>>>26-m&67108863,m+=24,m>=26&&(m-=26,d++);return this.strip()};function W(p,e,s){for(var a=0,h=Math.min(p.length,s),d=e;d<h;d++){var g=p.charCodeAt(d)-48;a<<=4,g>=49&&g<=54?a|=g-49+10:g>=17&&g<=22?a|=g-17+10:a|=g&15}return a}f.prototype._parseHex=function(e,s){this.length=Math.ceil((e.length-s)/6),this.words=new Array(this.length);for(var a=0;a<this.length;a++)this.words[a]=0;var h,d,g=0;for(a=e.length-6,h=0;a>=s;a-=6)d=W(e,a,a+6),this.words[h]|=d<<g&67108863,this.words[h+1]|=d>>>26-g&4194303,g+=24,g>=26&&(g-=26,h++);a+6!==s&&(d=W(e,s,a+6),this.words[h]|=d<<g&67108863,this.words[h+1]|=d>>>26-g&4194303),this.strip()};function C(p,e,s,a){for(var h=0,d=Math.min(p.length,s),g=e;g<d;g++){var m=p.charCodeAt(g)-48;h*=a,m>=49?h+=m-49+10:m>=17?h+=m-17+10:h+=m}return h}f.prototype._parseBase=function(e,s,a){this.words=[0],this.length=1;for(var h=0,d=1;d<=67108863;d*=s)h++;h--,d=d/s|0;for(var g=e.length-a,m=g%h,u=Math.min(g,g-m)+a,n=0,l=a;l<u;l+=h)n=C(e,l,l+h,s),this.imuln(d),this.words[0]+n<67108864?this.words[0]+=n:this._iaddn(n);if(m!==0){var T=1;for(n=C(e,l,e.length,s),l=0;l<m;l++)T*=s;this.imuln(T),this.words[0]+n<67108864?this.words[0]+=n:this._iaddn(n)}},f.prototype.copy=function(e){e.words=new Array(this.length);for(var s=0;s<this.length;s++)e.words[s]=this.words[s];e.length=this.length,e.negative=this.negative,e.red=this.red},f.prototype.clone=function(){var e=new f(null);return this.copy(e),e},f.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},f.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},f.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},f.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var D=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],Rt=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],H=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];f.prototype.toString=function(e,s){e=e||10,s=s|0||1;var a;if(e===16||e==="hex"){a="";for(var h=0,d=0,g=0;g<this.length;g++){var m=this.words[g],u=((m<<h|d)&16777215).toString(16);d=m>>>24-h&16777215,d!==0||g!==this.length-1?a=D[6-u.length]+u+a:a=u+a,h+=2,h>=26&&(h-=26,g--)}for(d!==0&&(a=d.toString(16)+a);a.length%s!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}if(e===(e|0)&&e>=2&&e<=36){var n=Rt[e],l=H[e];a="";var T=this.clone();for(T.negative=0;!T.isZero();){var R=T.modn(l).toString(e);T=T.idivn(l),T.isZero()?a=R+a:a=D[n-R.length]+R+a}for(this.isZero()&&(a="0"+a);a.length%s!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}c(!1,"Base should be between 2 and 36")},f.prototype.toNumber=function(){var e=this.words[0];return this.length===2?e+=this.words[1]*67108864:this.length===3&&this.words[2]===1?e+=4503599627370496+this.words[1]*67108864:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-e:e},f.prototype.toJSON=function(){return this.toString(16)},f.prototype.toBuffer=function(e,s){return c(typeof N<"u"),this.toArrayLike(N,e,s)},f.prototype.toArray=function(e,s){return this.toArrayLike(Array,e,s)},f.prototype.toArrayLike=function(e,s,a){var h=this.byteLength(),d=a||Math.max(1,h);c(h<=d,"byte array longer than desired length"),c(d>0,"Requested array length <= 0"),this.strip();var g=s==="le",m=new e(d),u,n,l=this.clone();if(g){for(n=0;!l.isZero();n++)u=l.andln(255),l.iushrn(8),m[n]=u;for(;n<d;n++)m[n]=0}else{for(n=0;n<d-h;n++)m[n]=0;for(n=0;!l.isZero();n++)u=l.andln(255),l.iushrn(8),m[d-n-1]=u}return m},Math.clz32?f.prototype._countBits=function(e){return 32-Math.clz32(e)}:f.prototype._countBits=function(e){var s=e,a=0;return s>=4096&&(a+=13,s>>>=13),s>=64&&(a+=7,s>>>=7),s>=8&&(a+=4,s>>>=4),s>=2&&(a+=2,s>>>=2),a+s},f.prototype._zeroBits=function(e){if(e===0)return 26;var s=e,a=0;return s&8191||(a+=13,s>>>=13),s&127||(a+=7,s>>>=7),s&15||(a+=4,s>>>=4),s&3||(a+=2,s>>>=2),s&1||a++,a},f.prototype.bitLength=function(){var e=this.words[this.length-1],s=this._countBits(e);return(this.length-1)*26+s};function Ot(p){for(var e=new Array(p.bitLength()),s=0;s<e.length;s++){var a=s/26|0,h=s%26;e[s]=(p.words[a]&1<<h)>>>h}return e}f.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,s=0;s<this.length;s++){var a=this._zeroBits(this.words[s]);if(e+=a,a!==26)break}return e},f.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},f.prototype.toTwos=function(e){return this.negative!==0?this.abs().inotn(e).iaddn(1):this.clone()},f.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},f.prototype.isNeg=function(){return this.negative!==0},f.prototype.neg=function(){return this.clone().ineg()},f.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},f.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var s=0;s<e.length;s++)this.words[s]=this.words[s]|e.words[s];return this.strip()},f.prototype.ior=function(e){return c((this.negative|e.negative)===0),this.iuor(e)},f.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},f.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},f.prototype.iuand=function(e){var s;this.length>e.length?s=e:s=this;for(var a=0;a<s.length;a++)this.words[a]=this.words[a]&e.words[a];return this.length=s.length,this.strip()},f.prototype.iand=function(e){return c((this.negative|e.negative)===0),this.iuand(e)},f.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},f.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},f.prototype.iuxor=function(e){var s,a;this.length>e.length?(s=this,a=e):(s=e,a=this);for(var h=0;h<a.length;h++)this.words[h]=s.words[h]^a.words[h];if(this!==s)for(;h<s.length;h++)this.words[h]=s.words[h];return this.length=s.length,this.strip()},f.prototype.ixor=function(e){return c((this.negative|e.negative)===0),this.iuxor(e)},f.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},f.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},f.prototype.inotn=function(e){c(typeof e=="number"&&e>=0);var s=Math.ceil(e/26)|0,a=e%26;this._expand(s),a>0&&s--;for(var h=0;h<s;h++)this.words[h]=~this.words[h]&67108863;return a>0&&(this.words[h]=~this.words[h]&67108863>>26-a),this.strip()},f.prototype.notn=function(e){return this.clone().inotn(e)},f.prototype.setn=function(e,s){c(typeof e=="number"&&e>=0);var a=e/26|0,h=e%26;return this._expand(a+1),s?this.words[a]=this.words[a]|1<<h:this.words[a]=this.words[a]&~(1<<h),this.strip()},f.prototype.iadd=function(e){var s;if(this.negative!==0&&e.negative===0)return this.negative=0,s=this.isub(e),this.negative^=1,this._normSign();if(this.negative===0&&e.negative!==0)return e.negative=0,s=this.isub(e),e.negative=1,s._normSign();var a,h;this.length>e.length?(a=this,h=e):(a=e,h=this);for(var d=0,g=0;g<h.length;g++)s=(a.words[g]|0)+(h.words[g]|0)+d,this.words[g]=s&67108863,d=s>>>26;for(;d!==0&&g<a.length;g++)s=(a.words[g]|0)+d,this.words[g]=s&67108863,d=s>>>26;if(this.length=a.length,d!==0)this.words[this.length]=d,this.length++;else if(a!==this)for(;g<a.length;g++)this.words[g]=a.words[g];return this},f.prototype.add=function(e){var s;return e.negative!==0&&this.negative===0?(e.negative=0,s=this.sub(e),e.negative^=1,s):e.negative===0&&this.negative!==0?(this.negative=0,s=e.sub(this),this.negative=1,s):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},f.prototype.isub=function(e){if(e.negative!==0){e.negative=0;var s=this.iadd(e);return e.negative=1,s._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var a=this.cmp(e);if(a===0)return this.negative=0,this.length=1,this.words[0]=0,this;var h,d;a>0?(h=this,d=e):(h=e,d=this);for(var g=0,m=0;m<d.length;m++)s=(h.words[m]|0)-(d.words[m]|0)+g,g=s>>26,this.words[m]=s&67108863;for(;g!==0&&m<h.length;m++)s=(h.words[m]|0)+g,g=s>>26,this.words[m]=s&67108863;if(g===0&&m<h.length&&h!==this)for(;m<h.length;m++)this.words[m]=h.words[m];return this.length=Math.max(this.length,m),h!==this&&(this.negative=1),this.strip()},f.prototype.sub=function(e){return this.clone().isub(e)};function At(p,e,s){s.negative=e.negative^p.negative;var a=p.length+e.length|0;s.length=a,a=a-1|0;var h=p.words[0]|0,d=e.words[0]|0,g=h*d,m=g&67108863,u=g/67108864|0;s.words[0]=m;for(var n=1;n<a;n++){for(var l=u>>>26,T=u&67108863,R=Math.min(n,e.length-1),F=Math.max(0,n-p.length+1);F<=R;F++){var q=n-F|0;h=p.words[q]|0,d=e.words[F]|0,g=h*d+T,l+=g/67108864|0,T=g&67108863}s.words[n]=T|0,u=l|0}return u!==0?s.words[n]=u|0:s.length--,s.strip()}var _t=function(e,s,a){var h=e.words,d=s.words,g=a.words,m=0,u,n,l,T=h[0]|0,R=T&8191,F=T>>>13,q=h[1]|0,o=q&8191,w=q>>>13,_=h[2]|0,M=_&8191,k=_>>>13,x=h[3]|0,I=x&8191,A=x>>>13,kt=h[4]|0,E=kt&8191,L=kt>>>13,zt=h[5]|0,$=zt&8191,K=zt>>>13,Vt=h[6]|0,J=Vt&8191,G=Vt>>>13,$t=h[7]|0,Z=$t&8191,Q=$t>>>13,Kt=h[8]|0,X=Kt&8191,Y=Kt>>>13,Jt=h[9]|0,tt=Jt&8191,et=Jt>>>13,Gt=d[0]|0,rt=Gt&8191,it=Gt>>>13,Zt=d[1]|0,nt=Zt&8191,st=Zt>>>13,Qt=d[2]|0,ot=Qt&8191,at=Qt>>>13,Xt=d[3]|0,ht=Xt&8191,ct=Xt>>>13,Yt=d[4]|0,ut=Yt&8191,lt=Yt>>>13,te=d[5]|0,ft=te&8191,dt=te>>>13,ee=d[6]|0,pt=ee&8191,gt=ee>>>13,re=d[7]|0,mt=re&8191,vt=re>>>13,ie=d[8]|0,wt=ie&8191,yt=ie>>>13,ne=d[9]|0,Mt=ne&8191,bt=ne>>>13;a.negative=e.negative^s.negative,a.length=19,u=Math.imul(R,rt),n=Math.imul(R,it),n=n+Math.imul(F,rt)|0,l=Math.imul(F,it);var Nt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,u=Math.imul(o,rt),n=Math.imul(o,it),n=n+Math.imul(w,rt)|0,l=Math.imul(w,it),u=u+Math.imul(R,nt)|0,n=n+Math.imul(R,st)|0,n=n+Math.imul(F,nt)|0,l=l+Math.imul(F,st)|0;var Ft=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,u=Math.imul(M,rt),n=Math.imul(M,it),n=n+Math.imul(k,rt)|0,l=Math.imul(k,it),u=u+Math.imul(o,nt)|0,n=n+Math.imul(o,st)|0,n=n+Math.imul(w,nt)|0,l=l+Math.imul(w,st)|0,u=u+Math.imul(R,ot)|0,n=n+Math.imul(R,at)|0,n=n+Math.imul(F,ot)|0,l=l+Math.imul(F,at)|0;var xt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,u=Math.imul(I,rt),n=Math.imul(I,it),n=n+Math.imul(A,rt)|0,l=Math.imul(A,it),u=u+Math.imul(M,nt)|0,n=n+Math.imul(M,st)|0,n=n+Math.imul(k,nt)|0,l=l+Math.imul(k,st)|0,u=u+Math.imul(o,ot)|0,n=n+Math.imul(o,at)|0,n=n+Math.imul(w,ot)|0,l=l+Math.imul(w,at)|0,u=u+Math.imul(R,ht)|0,n=n+Math.imul(R,ct)|0,n=n+Math.imul(F,ht)|0,l=l+Math.imul(F,ct)|0;var qt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(qt>>>26)|0,qt&=67108863,u=Math.imul(E,rt),n=Math.imul(E,it),n=n+Math.imul(L,rt)|0,l=Math.imul(L,it),u=u+Math.imul(I,nt)|0,n=n+Math.imul(I,st)|0,n=n+Math.imul(A,nt)|0,l=l+Math.imul(A,st)|0,u=u+Math.imul(M,ot)|0,n=n+Math.imul(M,at)|0,n=n+Math.imul(k,ot)|0,l=l+Math.imul(k,at)|0,u=u+Math.imul(o,ht)|0,n=n+Math.imul(o,ct)|0,n=n+Math.imul(w,ht)|0,l=l+Math.imul(w,ct)|0,u=u+Math.imul(R,ut)|0,n=n+Math.imul(R,lt)|0,n=n+Math.imul(F,ut)|0,l=l+Math.imul(F,lt)|0;var Pt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,u=Math.imul($,rt),n=Math.imul($,it),n=n+Math.imul(K,rt)|0,l=Math.imul(K,it),u=u+Math.imul(E,nt)|0,n=n+Math.imul(E,st)|0,n=n+Math.imul(L,nt)|0,l=l+Math.imul(L,st)|0,u=u+Math.imul(I,ot)|0,n=n+Math.imul(I,at)|0,n=n+Math.imul(A,ot)|0,l=l+Math.imul(A,at)|0,u=u+Math.imul(M,ht)|0,n=n+Math.imul(M,ct)|0,n=n+Math.imul(k,ht)|0,l=l+Math.imul(k,ct)|0,u=u+Math.imul(o,ut)|0,n=n+Math.imul(o,lt)|0,n=n+Math.imul(w,ut)|0,l=l+Math.imul(w,lt)|0,u=u+Math.imul(R,ft)|0,n=n+Math.imul(R,dt)|0,n=n+Math.imul(F,ft)|0,l=l+Math.imul(F,dt)|0;var Lt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,u=Math.imul(J,rt),n=Math.imul(J,it),n=n+Math.imul(G,rt)|0,l=Math.imul(G,it),u=u+Math.imul($,nt)|0,n=n+Math.imul($,st)|0,n=n+Math.imul(K,nt)|0,l=l+Math.imul(K,st)|0,u=u+Math.imul(E,ot)|0,n=n+Math.imul(E,at)|0,n=n+Math.imul(L,ot)|0,l=l+Math.imul(L,at)|0,u=u+Math.imul(I,ht)|0,n=n+Math.imul(I,ct)|0,n=n+Math.imul(A,ht)|0,l=l+Math.imul(A,ct)|0,u=u+Math.imul(M,ut)|0,n=n+Math.imul(M,lt)|0,n=n+Math.imul(k,ut)|0,l=l+Math.imul(k,lt)|0,u=u+Math.imul(o,ft)|0,n=n+Math.imul(o,dt)|0,n=n+Math.imul(w,ft)|0,l=l+Math.imul(w,dt)|0,u=u+Math.imul(R,pt)|0,n=n+Math.imul(R,gt)|0,n=n+Math.imul(F,pt)|0,l=l+Math.imul(F,gt)|0;var Wt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,u=Math.imul(Z,rt),n=Math.imul(Z,it),n=n+Math.imul(Q,rt)|0,l=Math.imul(Q,it),u=u+Math.imul(J,nt)|0,n=n+Math.imul(J,st)|0,n=n+Math.imul(G,nt)|0,l=l+Math.imul(G,st)|0,u=u+Math.imul($,ot)|0,n=n+Math.imul($,at)|0,n=n+Math.imul(K,ot)|0,l=l+Math.imul(K,at)|0,u=u+Math.imul(E,ht)|0,n=n+Math.imul(E,ct)|0,n=n+Math.imul(L,ht)|0,l=l+Math.imul(L,ct)|0,u=u+Math.imul(I,ut)|0,n=n+Math.imul(I,lt)|0,n=n+Math.imul(A,ut)|0,l=l+Math.imul(A,lt)|0,u=u+Math.imul(M,ft)|0,n=n+Math.imul(M,dt)|0,n=n+Math.imul(k,ft)|0,l=l+Math.imul(k,dt)|0,u=u+Math.imul(o,pt)|0,n=n+Math.imul(o,gt)|0,n=n+Math.imul(w,pt)|0,l=l+Math.imul(w,gt)|0,u=u+Math.imul(R,mt)|0,n=n+Math.imul(R,vt)|0,n=n+Math.imul(F,mt)|0,l=l+Math.imul(F,vt)|0;var Ut=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,u=Math.imul(X,rt),n=Math.imul(X,it),n=n+Math.imul(Y,rt)|0,l=Math.imul(Y,it),u=u+Math.imul(Z,nt)|0,n=n+Math.imul(Z,st)|0,n=n+Math.imul(Q,nt)|0,l=l+Math.imul(Q,st)|0,u=u+Math.imul(J,ot)|0,n=n+Math.imul(J,at)|0,n=n+Math.imul(G,ot)|0,l=l+Math.imul(G,at)|0,u=u+Math.imul($,ht)|0,n=n+Math.imul($,ct)|0,n=n+Math.imul(K,ht)|0,l=l+Math.imul(K,ct)|0,u=u+Math.imul(E,ut)|0,n=n+Math.imul(E,lt)|0,n=n+Math.imul(L,ut)|0,l=l+Math.imul(L,lt)|0,u=u+Math.imul(I,ft)|0,n=n+Math.imul(I,dt)|0,n=n+Math.imul(A,ft)|0,l=l+Math.imul(A,dt)|0,u=u+Math.imul(M,pt)|0,n=n+Math.imul(M,gt)|0,n=n+Math.imul(k,pt)|0,l=l+Math.imul(k,gt)|0,u=u+Math.imul(o,mt)|0,n=n+Math.imul(o,vt)|0,n=n+Math.imul(w,mt)|0,l=l+Math.imul(w,vt)|0,u=u+Math.imul(R,wt)|0,n=n+Math.imul(R,yt)|0,n=n+Math.imul(F,wt)|0,l=l+Math.imul(F,yt)|0;var we=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(we>>>26)|0,we&=67108863,u=Math.imul(tt,rt),n=Math.imul(tt,it),n=n+Math.imul(et,rt)|0,l=Math.imul(et,it),u=u+Math.imul(X,nt)|0,n=n+Math.imul(X,st)|0,n=n+Math.imul(Y,nt)|0,l=l+Math.imul(Y,st)|0,u=u+Math.imul(Z,ot)|0,n=n+Math.imul(Z,at)|0,n=n+Math.imul(Q,ot)|0,l=l+Math.imul(Q,at)|0,u=u+Math.imul(J,ht)|0,n=n+Math.imul(J,ct)|0,n=n+Math.imul(G,ht)|0,l=l+Math.imul(G,ct)|0,u=u+Math.imul($,ut)|0,n=n+Math.imul($,lt)|0,n=n+Math.imul(K,ut)|0,l=l+Math.imul(K,lt)|0,u=u+Math.imul(E,ft)|0,n=n+Math.imul(E,dt)|0,n=n+Math.imul(L,ft)|0,l=l+Math.imul(L,dt)|0,u=u+Math.imul(I,pt)|0,n=n+Math.imul(I,gt)|0,n=n+Math.imul(A,pt)|0,l=l+Math.imul(A,gt)|0,u=u+Math.imul(M,mt)|0,n=n+Math.imul(M,vt)|0,n=n+Math.imul(k,mt)|0,l=l+Math.imul(k,vt)|0,u=u+Math.imul(o,wt)|0,n=n+Math.imul(o,yt)|0,n=n+Math.imul(w,wt)|0,l=l+Math.imul(w,yt)|0,u=u+Math.imul(R,Mt)|0,n=n+Math.imul(R,bt)|0,n=n+Math.imul(F,Mt)|0,l=l+Math.imul(F,bt)|0;var ye=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,u=Math.imul(tt,nt),n=Math.imul(tt,st),n=n+Math.imul(et,nt)|0,l=Math.imul(et,st),u=u+Math.imul(X,ot)|0,n=n+Math.imul(X,at)|0,n=n+Math.imul(Y,ot)|0,l=l+Math.imul(Y,at)|0,u=u+Math.imul(Z,ht)|0,n=n+Math.imul(Z,ct)|0,n=n+Math.imul(Q,ht)|0,l=l+Math.imul(Q,ct)|0,u=u+Math.imul(J,ut)|0,n=n+Math.imul(J,lt)|0,n=n+Math.imul(G,ut)|0,l=l+Math.imul(G,lt)|0,u=u+Math.imul($,ft)|0,n=n+Math.imul($,dt)|0,n=n+Math.imul(K,ft)|0,l=l+Math.imul(K,dt)|0,u=u+Math.imul(E,pt)|0,n=n+Math.imul(E,gt)|0,n=n+Math.imul(L,pt)|0,l=l+Math.imul(L,gt)|0,u=u+Math.imul(I,mt)|0,n=n+Math.imul(I,vt)|0,n=n+Math.imul(A,mt)|0,l=l+Math.imul(A,vt)|0,u=u+Math.imul(M,wt)|0,n=n+Math.imul(M,yt)|0,n=n+Math.imul(k,wt)|0,l=l+Math.imul(k,yt)|0,u=u+Math.imul(o,Mt)|0,n=n+Math.imul(o,bt)|0,n=n+Math.imul(w,Mt)|0,l=l+Math.imul(w,bt)|0;var Me=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,u=Math.imul(tt,ot),n=Math.imul(tt,at),n=n+Math.imul(et,ot)|0,l=Math.imul(et,at),u=u+Math.imul(X,ht)|0,n=n+Math.imul(X,ct)|0,n=n+Math.imul(Y,ht)|0,l=l+Math.imul(Y,ct)|0,u=u+Math.imul(Z,ut)|0,n=n+Math.imul(Z,lt)|0,n=n+Math.imul(Q,ut)|0,l=l+Math.imul(Q,lt)|0,u=u+Math.imul(J,ft)|0,n=n+Math.imul(J,dt)|0,n=n+Math.imul(G,ft)|0,l=l+Math.imul(G,dt)|0,u=u+Math.imul($,pt)|0,n=n+Math.imul($,gt)|0,n=n+Math.imul(K,pt)|0,l=l+Math.imul(K,gt)|0,u=u+Math.imul(E,mt)|0,n=n+Math.imul(E,vt)|0,n=n+Math.imul(L,mt)|0,l=l+Math.imul(L,vt)|0,u=u+Math.imul(I,wt)|0,n=n+Math.imul(I,yt)|0,n=n+Math.imul(A,wt)|0,l=l+Math.imul(A,yt)|0,u=u+Math.imul(M,Mt)|0,n=n+Math.imul(M,bt)|0,n=n+Math.imul(k,Mt)|0,l=l+Math.imul(k,bt)|0;var be=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(be>>>26)|0,be&=67108863,u=Math.imul(tt,ht),n=Math.imul(tt,ct),n=n+Math.imul(et,ht)|0,l=Math.imul(et,ct),u=u+Math.imul(X,ut)|0,n=n+Math.imul(X,lt)|0,n=n+Math.imul(Y,ut)|0,l=l+Math.imul(Y,lt)|0,u=u+Math.imul(Z,ft)|0,n=n+Math.imul(Z,dt)|0,n=n+Math.imul(Q,ft)|0,l=l+Math.imul(Q,dt)|0,u=u+Math.imul(J,pt)|0,n=n+Math.imul(J,gt)|0,n=n+Math.imul(G,pt)|0,l=l+Math.imul(G,gt)|0,u=u+Math.imul($,mt)|0,n=n+Math.imul($,vt)|0,n=n+Math.imul(K,mt)|0,l=l+Math.imul(K,vt)|0,u=u+Math.imul(E,wt)|0,n=n+Math.imul(E,yt)|0,n=n+Math.imul(L,wt)|0,l=l+Math.imul(L,yt)|0,u=u+Math.imul(I,Mt)|0,n=n+Math.imul(I,bt)|0,n=n+Math.imul(A,Mt)|0,l=l+Math.imul(A,bt)|0;var _e=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,u=Math.imul(tt,ut),n=Math.imul(tt,lt),n=n+Math.imul(et,ut)|0,l=Math.imul(et,lt),u=u+Math.imul(X,ft)|0,n=n+Math.imul(X,dt)|0,n=n+Math.imul(Y,ft)|0,l=l+Math.imul(Y,dt)|0,u=u+Math.imul(Z,pt)|0,n=n+Math.imul(Z,gt)|0,n=n+Math.imul(Q,pt)|0,l=l+Math.imul(Q,gt)|0,u=u+Math.imul(J,mt)|0,n=n+Math.imul(J,vt)|0,n=n+Math.imul(G,mt)|0,l=l+Math.imul(G,vt)|0,u=u+Math.imul($,wt)|0,n=n+Math.imul($,yt)|0,n=n+Math.imul(K,wt)|0,l=l+Math.imul(K,yt)|0,u=u+Math.imul(E,Mt)|0,n=n+Math.imul(E,bt)|0,n=n+Math.imul(L,Mt)|0,l=l+Math.imul(L,bt)|0;var Se=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,u=Math.imul(tt,ft),n=Math.imul(tt,dt),n=n+Math.imul(et,ft)|0,l=Math.imul(et,dt),u=u+Math.imul(X,pt)|0,n=n+Math.imul(X,gt)|0,n=n+Math.imul(Y,pt)|0,l=l+Math.imul(Y,gt)|0,u=u+Math.imul(Z,mt)|0,n=n+Math.imul(Z,vt)|0,n=n+Math.imul(Q,mt)|0,l=l+Math.imul(Q,vt)|0,u=u+Math.imul(J,wt)|0,n=n+Math.imul(J,yt)|0,n=n+Math.imul(G,wt)|0,l=l+Math.imul(G,yt)|0,u=u+Math.imul($,Mt)|0,n=n+Math.imul($,bt)|0,n=n+Math.imul(K,Mt)|0,l=l+Math.imul(K,bt)|0;var ke=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,u=Math.imul(tt,pt),n=Math.imul(tt,gt),n=n+Math.imul(et,pt)|0,l=Math.imul(et,gt),u=u+Math.imul(X,mt)|0,n=n+Math.imul(X,vt)|0,n=n+Math.imul(Y,mt)|0,l=l+Math.imul(Y,vt)|0,u=u+Math.imul(Z,wt)|0,n=n+Math.imul(Z,yt)|0,n=n+Math.imul(Q,wt)|0,l=l+Math.imul(Q,yt)|0,u=u+Math.imul(J,Mt)|0,n=n+Math.imul(J,bt)|0,n=n+Math.imul(G,Mt)|0,l=l+Math.imul(G,bt)|0;var Re=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,u=Math.imul(tt,mt),n=Math.imul(tt,vt),n=n+Math.imul(et,mt)|0,l=Math.imul(et,vt),u=u+Math.imul(X,wt)|0,n=n+Math.imul(X,yt)|0,n=n+Math.imul(Y,wt)|0,l=l+Math.imul(Y,yt)|0,u=u+Math.imul(Z,Mt)|0,n=n+Math.imul(Z,bt)|0,n=n+Math.imul(Q,Mt)|0,l=l+Math.imul(Q,bt)|0;var Oe=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,u=Math.imul(tt,wt),n=Math.imul(tt,yt),n=n+Math.imul(et,wt)|0,l=Math.imul(et,yt),u=u+Math.imul(X,Mt)|0,n=n+Math.imul(X,bt)|0,n=n+Math.imul(Y,Mt)|0,l=l+Math.imul(Y,bt)|0;var Ae=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,u=Math.imul(tt,Mt),n=Math.imul(tt,bt),n=n+Math.imul(et,Mt)|0,l=Math.imul(et,bt);var Ie=(m+u|0)+((n&8191)<<13)|0;return m=(l+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,g[0]=Nt,g[1]=Ft,g[2]=xt,g[3]=qt,g[4]=Pt,g[5]=Lt,g[6]=Wt,g[7]=Ut,g[8]=we,g[9]=ye,g[10]=Me,g[11]=be,g[12]=_e,g[13]=Se,g[14]=ke,g[15]=Re,g[16]=Oe,g[17]=Ae,g[18]=Ie,m!==0&&(g[19]=m,a.length++),a};Math.imul||(_t=At);function Tt(p,e,s){s.negative=e.negative^p.negative,s.length=p.length+e.length;for(var a=0,h=0,d=0;d<s.length-1;d++){var g=h;h=0;for(var m=a&67108863,u=Math.min(d,e.length-1),n=Math.max(0,d-p.length+1);n<=u;n++){var l=d-n,T=p.words[l]|0,R=e.words[n]|0,F=T*R,q=F&67108863;g=g+(F/67108864|0)|0,q=q+m|0,m=q&67108863,g=g+(q>>>26)|0,h+=g>>>26,g&=67108863}s.words[d]=m,a=g,g=h}return a!==0?s.words[d]=a:s.length--,s.strip()}function y(p,e,s){var a=new S;return a.mulp(p,e,s)}f.prototype.mulTo=function(e,s){var a,h=this.length+e.length;return this.length===10&&e.length===10?a=_t(this,e,s):h<63?a=At(this,e,s):h<1024?a=Tt(this,e,s):a=y(this,e,s),a};function S(p,e){this.x=p,this.y=e}S.prototype.makeRBT=function(e){for(var s=new Array(e),a=f.prototype._countBits(e)-1,h=0;h<e;h++)s[h]=this.revBin(h,a,e);return s},S.prototype.revBin=function(e,s,a){if(e===0||e===a-1)return e;for(var h=0,d=0;d<s;d++)h|=(e&1)<<s-d-1,e>>=1;return h},S.prototype.permute=function(e,s,a,h,d,g){for(var m=0;m<g;m++)h[m]=s[e[m]],d[m]=a[e[m]]},S.prototype.transform=function(e,s,a,h,d,g){this.permute(g,e,s,a,h,d);for(var m=1;m<d;m<<=1)for(var u=m<<1,n=Math.cos(2*Math.PI/u),l=Math.sin(2*Math.PI/u),T=0;T<d;T+=u)for(var R=n,F=l,q=0;q<m;q++){var o=a[T+q],w=h[T+q],_=a[T+q+m],M=h[T+q+m],k=R*_-F*M;M=R*M+F*_,_=k,a[T+q]=o+_,h[T+q]=w+M,a[T+q+m]=o-_,h[T+q+m]=w-M,q!==u&&(k=n*R-l*F,F=n*F+l*R,R=k)}},S.prototype.guessLen13b=function(e,s){var a=Math.max(s,e)|1,h=a&1,d=0;for(a=a/2|0;a;a=a>>>1)d++;return 1<<d+1+h},S.prototype.conjugate=function(e,s,a){if(!(a<=1))for(var h=0;h<a/2;h++){var d=e[h];e[h]=e[a-h-1],e[a-h-1]=d,d=s[h],s[h]=-s[a-h-1],s[a-h-1]=-d}},S.prototype.normalize13b=function(e,s){for(var a=0,h=0;h<s/2;h++){var d=Math.round(e[2*h+1]/s)*8192+Math.round(e[2*h]/s)+a;e[h]=d&67108863,d<67108864?a=0:a=d/67108864|0}return e},S.prototype.convert13b=function(e,s,a,h){for(var d=0,g=0;g<s;g++)d=d+(e[g]|0),a[2*g]=d&8191,d=d>>>13,a[2*g+1]=d&8191,d=d>>>13;for(g=2*s;g<h;++g)a[g]=0;c(d===0),c((d&-8192)===0)},S.prototype.stub=function(e){for(var s=new Array(e),a=0;a<e;a++)s[a]=0;return s},S.prototype.mulp=function(e,s,a){var h=2*this.guessLen13b(e.length,s.length),d=this.makeRBT(h),g=this.stub(h),m=new Array(h),u=new Array(h),n=new Array(h),l=new Array(h),T=new Array(h),R=new Array(h),F=a.words;F.length=h,this.convert13b(e.words,e.length,m,h),this.convert13b(s.words,s.length,l,h),this.transform(m,g,u,n,h,d),this.transform(l,g,T,R,h,d);for(var q=0;q<h;q++){var o=u[q]*T[q]-n[q]*R[q];n[q]=u[q]*R[q]+n[q]*T[q],u[q]=o}return this.conjugate(u,n,h),this.transform(u,n,F,g,h,d),this.conjugate(F,g,h),this.normalize13b(F,h),a.negative=e.negative^s.negative,a.length=e.length+s.length,a.strip()},f.prototype.mul=function(e){var s=new f(null);return s.words=new Array(this.length+e.length),this.mulTo(e,s)},f.prototype.mulf=function(e){var s=new f(null);return s.words=new Array(this.length+e.length),y(this,e,s)},f.prototype.imul=function(e){return this.clone().mulTo(e,this)},f.prototype.imuln=function(e){c(typeof e=="number"),c(e<67108864);for(var s=0,a=0;a<this.length;a++){var h=(this.words[a]|0)*e,d=(h&67108863)+(s&67108863);s>>=26,s+=h/67108864|0,s+=d>>>26,this.words[a]=d&67108863}return s!==0&&(this.words[a]=s,this.length++),this},f.prototype.muln=function(e){return this.clone().imuln(e)},f.prototype.sqr=function(){return this.mul(this)},f.prototype.isqr=function(){return this.imul(this.clone())},f.prototype.pow=function(e){var s=Ot(e);if(s.length===0)return new f(1);for(var a=this,h=0;h<s.length&&s[h]===0;h++,a=a.sqr());if(++h<s.length)for(var d=a.sqr();h<s.length;h++,d=d.sqr())s[h]!==0&&(a=a.mul(d));return a},f.prototype.iushln=function(e){c(typeof e=="number"&&e>=0);var s=e%26,a=(e-s)/26,h=67108863>>>26-s<<26-s,d;if(s!==0){var g=0;for(d=0;d<this.length;d++){var m=this.words[d]&h,u=(this.words[d]|0)-m<<s;this.words[d]=u|g,g=m>>>26-s}g&&(this.words[d]=g,this.length++)}if(a!==0){for(d=this.length-1;d>=0;d--)this.words[d+a]=this.words[d];for(d=0;d<a;d++)this.words[d]=0;this.length+=a}return this.strip()},f.prototype.ishln=function(e){return c(this.negative===0),this.iushln(e)},f.prototype.iushrn=function(e,s,a){c(typeof e=="number"&&e>=0);var h;s?h=(s-s%26)/26:h=0;var d=e%26,g=Math.min((e-d)/26,this.length),m=67108863^67108863>>>d<<d,u=a;if(h-=g,h=Math.max(0,h),u){for(var n=0;n<g;n++)u.words[n]=this.words[n];u.length=g}if(g!==0)if(this.length>g)for(this.length-=g,n=0;n<this.length;n++)this.words[n]=this.words[n+g];else this.words[0]=0,this.length=1;var l=0;for(n=this.length-1;n>=0&&(l!==0||n>=h);n--){var T=this.words[n]|0;this.words[n]=l<<26-d|T>>>d,l=T&m}return u&&l!==0&&(u.words[u.length++]=l),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},f.prototype.ishrn=function(e,s,a){return c(this.negative===0),this.iushrn(e,s,a)},f.prototype.shln=function(e){return this.clone().ishln(e)},f.prototype.ushln=function(e){return this.clone().iushln(e)},f.prototype.shrn=function(e){return this.clone().ishrn(e)},f.prototype.ushrn=function(e){return this.clone().iushrn(e)},f.prototype.testn=function(e){c(typeof e=="number"&&e>=0);var s=e%26,a=(e-s)/26,h=1<<s;if(this.length<=a)return!1;var d=this.words[a];return!!(d&h)},f.prototype.imaskn=function(e){c(typeof e=="number"&&e>=0);var s=e%26,a=(e-s)/26;if(c(this.negative===0,"imaskn works only with positive numbers"),this.length<=a)return this;if(s!==0&&a++,this.length=Math.min(a,this.length),s!==0){var h=67108863^67108863>>>s<<s;this.words[this.length-1]&=h}return this.strip()},f.prototype.maskn=function(e){return this.clone().imaskn(e)},f.prototype.iaddn=function(e){return c(typeof e=="number"),c(e<67108864),e<0?this.isubn(-e):this.negative!==0?this.length===1&&(this.words[0]|0)<e?(this.words[0]=e-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},f.prototype._iaddn=function(e){this.words[0]+=e;for(var s=0;s<this.length&&this.words[s]>=67108864;s++)this.words[s]-=67108864,s===this.length-1?this.words[s+1]=1:this.words[s+1]++;return this.length=Math.max(this.length,s+1),this},f.prototype.isubn=function(e){if(c(typeof e=="number"),c(e<67108864),e<0)return this.iaddn(-e);if(this.negative!==0)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var s=0;s<this.length&&this.words[s]<0;s++)this.words[s]+=67108864,this.words[s+1]-=1;return this.strip()},f.prototype.addn=function(e){return this.clone().iaddn(e)},f.prototype.subn=function(e){return this.clone().isubn(e)},f.prototype.iabs=function(){return this.negative=0,this},f.prototype.abs=function(){return this.clone().iabs()},f.prototype._ishlnsubmul=function(e,s,a){var h=e.length+a,d;this._expand(h);var g,m=0;for(d=0;d<e.length;d++){g=(this.words[d+a]|0)+m;var u=(e.words[d]|0)*s;g-=u&67108863,m=(g>>26)-(u/67108864|0),this.words[d+a]=g&67108863}for(;d<this.length-a;d++)g=(this.words[d+a]|0)+m,m=g>>26,this.words[d+a]=g&67108863;if(m===0)return this.strip();for(c(m===-1),m=0,d=0;d<this.length;d++)g=-(this.words[d]|0)+m,m=g>>26,this.words[d]=g&67108863;return this.negative=1,this.strip()},f.prototype._wordDiv=function(e,s){var a=this.length-e.length,h=this.clone(),d=e,g=d.words[d.length-1]|0,m=this._countBits(g);a=26-m,a!==0&&(d=d.ushln(a),h.iushln(a),g=d.words[d.length-1]|0);var u=h.length-d.length,n;if(s!=="mod"){n=new f(null),n.length=u+1,n.words=new Array(n.length);for(var l=0;l<n.length;l++)n.words[l]=0}var T=h.clone()._ishlnsubmul(d,1,u);T.negative===0&&(h=T,n&&(n.words[u]=1));for(var R=u-1;R>=0;R--){var F=(h.words[d.length+R]|0)*67108864+(h.words[d.length+R-1]|0);for(F=Math.min(F/g|0,67108863),h._ishlnsubmul(d,F,R);h.negative!==0;)F--,h.negative=0,h._ishlnsubmul(d,1,R),h.isZero()||(h.negative^=1);n&&(n.words[R]=F)}return n&&n.strip(),h.strip(),s!=="div"&&a!==0&&h.iushrn(a),{div:n||null,mod:h}},f.prototype.divmod=function(e,s,a){if(c(!e.isZero()),this.isZero())return{div:new f(0),mod:new f(0)};var h,d,g;return this.negative!==0&&e.negative===0?(g=this.neg().divmod(e,s),s!=="mod"&&(h=g.div.neg()),s!=="div"&&(d=g.mod.neg(),a&&d.negative!==0&&d.iadd(e)),{div:h,mod:d}):this.negative===0&&e.negative!==0?(g=this.divmod(e.neg(),s),s!=="mod"&&(h=g.div.neg()),{div:h,mod:g.mod}):this.negative&e.negative?(g=this.neg().divmod(e.neg(),s),s!=="div"&&(d=g.mod.neg(),a&&d.negative!==0&&d.isub(e)),{div:g.div,mod:d}):e.length>this.length||this.cmp(e)<0?{div:new f(0),mod:this}:e.length===1?s==="div"?{div:this.divn(e.words[0]),mod:null}:s==="mod"?{div:null,mod:new f(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new f(this.modn(e.words[0]))}:this._wordDiv(e,s)},f.prototype.div=function(e){return this.divmod(e,"div",!1).div},f.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},f.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},f.prototype.divRound=function(e){var s=this.divmod(e);if(s.mod.isZero())return s.div;var a=s.div.negative!==0?s.mod.isub(e):s.mod,h=e.ushrn(1),d=e.andln(1),g=a.cmp(h);return g<0||d===1&&g===0?s.div:s.div.negative!==0?s.div.isubn(1):s.div.iaddn(1)},f.prototype.modn=function(e){c(e<=67108863);for(var s=(1<<26)%e,a=0,h=this.length-1;h>=0;h--)a=(s*a+(this.words[h]|0))%e;return a},f.prototype.idivn=function(e){c(e<=67108863);for(var s=0,a=this.length-1;a>=0;a--){var h=(this.words[a]|0)+s*67108864;this.words[a]=h/e|0,s=h%e}return this.strip()},f.prototype.divn=function(e){return this.clone().idivn(e)},f.prototype.egcd=function(e){c(e.negative===0),c(!e.isZero());var s=this,a=e.clone();s.negative!==0?s=s.umod(e):s=s.clone();for(var h=new f(1),d=new f(0),g=new f(0),m=new f(1),u=0;s.isEven()&&a.isEven();)s.iushrn(1),a.iushrn(1),++u;for(var n=a.clone(),l=s.clone();!s.isZero();){for(var T=0,R=1;!(s.words[0]&R)&&T<26;++T,R<<=1);if(T>0)for(s.iushrn(T);T-- >0;)(h.isOdd()||d.isOdd())&&(h.iadd(n),d.isub(l)),h.iushrn(1),d.iushrn(1);for(var F=0,q=1;!(a.words[0]&q)&&F<26;++F,q<<=1);if(F>0)for(a.iushrn(F);F-- >0;)(g.isOdd()||m.isOdd())&&(g.iadd(n),m.isub(l)),g.iushrn(1),m.iushrn(1);s.cmp(a)>=0?(s.isub(a),h.isub(g),d.isub(m)):(a.isub(s),g.isub(h),m.isub(d))}return{a:g,b:m,gcd:a.iushln(u)}},f.prototype._invmp=function(e){c(e.negative===0),c(!e.isZero());var s=this,a=e.clone();s.negative!==0?s=s.umod(e):s=s.clone();for(var h=new f(1),d=new f(0),g=a.clone();s.cmpn(1)>0&&a.cmpn(1)>0;){for(var m=0,u=1;!(s.words[0]&u)&&m<26;++m,u<<=1);if(m>0)for(s.iushrn(m);m-- >0;)h.isOdd()&&h.iadd(g),h.iushrn(1);for(var n=0,l=1;!(a.words[0]&l)&&n<26;++n,l<<=1);if(n>0)for(a.iushrn(n);n-- >0;)d.isOdd()&&d.iadd(g),d.iushrn(1);s.cmp(a)>=0?(s.isub(a),h.isub(d)):(a.isub(s),d.isub(h))}var T;return s.cmpn(1)===0?T=h:T=d,T.cmpn(0)<0&&T.iadd(e),T},f.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var s=this.clone(),a=e.clone();s.negative=0,a.negative=0;for(var h=0;s.isEven()&&a.isEven();h++)s.iushrn(1),a.iushrn(1);do{for(;s.isEven();)s.iushrn(1);for(;a.isEven();)a.iushrn(1);var d=s.cmp(a);if(d<0){var g=s;s=a,a=g}else if(d===0||a.cmpn(1)===0)break;s.isub(a)}while(!0);return a.iushln(h)},f.prototype.invm=function(e){return this.egcd(e).a.umod(e)},f.prototype.isEven=function(){return(this.words[0]&1)===0},f.prototype.isOdd=function(){return(this.words[0]&1)===1},f.prototype.andln=function(e){return this.words[0]&e},f.prototype.bincn=function(e){c(typeof e=="number");var s=e%26,a=(e-s)/26,h=1<<s;if(this.length<=a)return this._expand(a+1),this.words[a]|=h,this;for(var d=h,g=a;d!==0&&g<this.length;g++){var m=this.words[g]|0;m+=d,d=m>>>26,m&=67108863,this.words[g]=m}return d!==0&&(this.words[g]=d,this.length++),this},f.prototype.isZero=function(){return this.length===1&&this.words[0]===0},f.prototype.cmpn=function(e){var s=e<0;if(this.negative!==0&&!s)return-1;if(this.negative===0&&s)return 1;this.strip();var a;if(this.length>1)a=1;else{s&&(e=-e),c(e<=67108863,"Number is too big");var h=this.words[0]|0;a=h===e?0:h<e?-1:1}return this.negative!==0?-a|0:a},f.prototype.cmp=function(e){if(this.negative!==0&&e.negative===0)return-1;if(this.negative===0&&e.negative!==0)return 1;var s=this.ucmp(e);return this.negative!==0?-s|0:s},f.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var s=0,a=this.length-1;a>=0;a--){var h=this.words[a]|0,d=e.words[a]|0;if(h!==d){h<d?s=-1:h>d&&(s=1);break}}return s},f.prototype.gtn=function(e){return this.cmpn(e)===1},f.prototype.gt=function(e){return this.cmp(e)===1},f.prototype.gten=function(e){return this.cmpn(e)>=0},f.prototype.gte=function(e){return this.cmp(e)>=0},f.prototype.ltn=function(e){return this.cmpn(e)===-1},f.prototype.lt=function(e){return this.cmp(e)===-1},f.prototype.lten=function(e){return this.cmpn(e)<=0},f.prototype.lte=function(e){return this.cmp(e)<=0},f.prototype.eqn=function(e){return this.cmpn(e)===0},f.prototype.eq=function(e){return this.cmp(e)===0},f.red=function(e){return new z(e)},f.prototype.toRed=function(e){return c(!this.red,"Already a number in reduction context"),c(this.negative===0,"red works only with positives"),e.convertTo(this)._forceRed(e)},f.prototype.fromRed=function(){return c(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},f.prototype._forceRed=function(e){return this.red=e,this},f.prototype.forceRed=function(e){return c(!this.red,"Already a number in reduction context"),this._forceRed(e)},f.prototype.redAdd=function(e){return c(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},f.prototype.redIAdd=function(e){return c(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},f.prototype.redSub=function(e){return c(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},f.prototype.redISub=function(e){return c(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},f.prototype.redShl=function(e){return c(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},f.prototype.redMul=function(e){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},f.prototype.redIMul=function(e){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},f.prototype.redSqr=function(){return c(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},f.prototype.redISqr=function(){return c(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},f.prototype.redSqrt=function(){return c(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},f.prototype.redInvm=function(){return c(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},f.prototype.redNeg=function(){return c(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},f.prototype.redPow=function(e){return c(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var B={k256:null,p224:null,p192:null,p25519:null};function O(p,e){this.name=p,this.p=new f(e,16),this.n=this.p.bitLength(),this.k=new f(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}O.prototype._tmp=function(){var e=new f(null);return e.words=new Array(Math.ceil(this.n/13)),e},O.prototype.ireduce=function(e){var s=e,a;do this.split(s,this.tmp),s=this.imulK(s),s=s.iadd(this.tmp),a=s.bitLength();while(a>this.n);var h=a<this.n?-1:s.ucmp(this.p);return h===0?(s.words[0]=0,s.length=1):h>0?s.isub(this.p):s.strip(),s},O.prototype.split=function(e,s){e.iushrn(this.n,0,s)},O.prototype.imulK=function(e){return e.imul(this.k)};function P(){O.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}v(P,O),P.prototype.split=function(e,s){for(var a=4194303,h=Math.min(e.length,9),d=0;d<h;d++)s.words[d]=e.words[d];if(s.length=h,e.length<=9){e.words[0]=0,e.length=1;return}var g=e.words[9];for(s.words[s.length++]=g&a,d=10;d<e.length;d++){var m=e.words[d]|0;e.words[d-10]=(m&a)<<4|g>>>22,g=m}g>>>=22,e.words[d-10]=g,g===0&&e.length>10?e.length-=10:e.length-=9},P.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var s=0,a=0;a<e.length;a++){var h=e.words[a]|0;s+=h*977,e.words[a]=s&67108863,s=h*64+(s/67108864|0)}return e.words[e.length-1]===0&&(e.length--,e.words[e.length-1]===0&&e.length--),e};function St(){O.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}v(St,O);function U(){O.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}v(U,O);function Et(){O.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}v(Et,O),Et.prototype.imulK=function(e){for(var s=0,a=0;a<e.length;a++){var h=(e.words[a]|0)*19+s,d=h&67108863;h>>>=26,e.words[a]=d,s=h}return s!==0&&(e.words[e.length++]=s),e},f._prime=function(e){if(B[e])return B[e];var s;if(e==="k256")s=new P;else if(e==="p224")s=new St;else if(e==="p192")s=new U;else if(e==="p25519")s=new Et;else throw new Error("Unknown prime "+e);return B[e]=s,s};function z(p){if(typeof p=="string"){var e=f._prime(p);this.m=e.p,this.prime=e}else c(p.gtn(1),"modulus must be greater than 1"),this.m=p,this.prime=null}z.prototype._verify1=function(e){c(e.negative===0,"red works only with positives"),c(e.red,"red works only with red numbers")},z.prototype._verify2=function(e,s){c((e.negative|s.negative)===0,"red works only with positives"),c(e.red&&e.red===s.red,"red works only with red numbers")},z.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},z.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},z.prototype.add=function(e,s){this._verify2(e,s);var a=e.add(s);return a.cmp(this.m)>=0&&a.isub(this.m),a._forceRed(this)},z.prototype.iadd=function(e,s){this._verify2(e,s);var a=e.iadd(s);return a.cmp(this.m)>=0&&a.isub(this.m),a},z.prototype.sub=function(e,s){this._verify2(e,s);var a=e.sub(s);return a.cmpn(0)<0&&a.iadd(this.m),a._forceRed(this)},z.prototype.isub=function(e,s){this._verify2(e,s);var a=e.isub(s);return a.cmpn(0)<0&&a.iadd(this.m),a},z.prototype.shl=function(e,s){return this._verify1(e),this.imod(e.ushln(s))},z.prototype.imul=function(e,s){return this._verify2(e,s),this.imod(e.imul(s))},z.prototype.mul=function(e,s){return this._verify2(e,s),this.imod(e.mul(s))},z.prototype.isqr=function(e){return this.imul(e,e.clone())},z.prototype.sqr=function(e){return this.mul(e,e)},z.prototype.sqrt=function(e){if(e.isZero())return e.clone();var s=this.m.andln(3);if(c(s%2===1),s===3){var a=this.m.add(new f(1)).iushrn(2);return this.pow(e,a)}for(var h=this.m.subn(1),d=0;!h.isZero()&&h.andln(1)===0;)d++,h.iushrn(1);c(!h.isZero());var g=new f(1).toRed(this),m=g.redNeg(),u=this.m.subn(1).iushrn(1),n=this.m.bitLength();for(n=new f(2*n*n).toRed(this);this.pow(n,u).cmp(m)!==0;)n.redIAdd(m);for(var l=this.pow(n,h),T=this.pow(e,h.addn(1).iushrn(1)),R=this.pow(e,h),F=d;R.cmp(g)!==0;){for(var q=R,o=0;q.cmp(g)!==0;o++)q=q.redSqr();c(o<F);var w=this.pow(l,new f(1).iushln(F-o-1));T=T.redMul(w),l=w.redSqr(),R=R.redMul(l),F=o}return T},z.prototype.invm=function(e){var s=e._invmp(this.m);return s.negative!==0?(s.negative=0,this.imod(s).redNeg()):this.imod(s)},z.prototype.pow=function(e,s){if(s.isZero())return new f(1).toRed(this);if(s.cmpn(1)===0)return e.clone();var a=4,h=new Array(1<<a);h[0]=new f(1).toRed(this),h[1]=e;for(var d=2;d<h.length;d++)h[d]=this.mul(h[d-1],e);var g=h[0],m=0,u=0,n=s.bitLength()%26;for(n===0&&(n=26),d=s.length-1;d>=0;d--){for(var l=s.words[d],T=n-1;T>=0;T--){var R=l>>T&1;if(g!==h[0]&&(g=this.sqr(g)),R===0&&m===0){u=0;continue}m<<=1,m|=R,u++,!(u!==a&&(d!==0||T!==0))&&(g=this.mul(g,h[m]),u=0,m=0)}n=26}return g},z.prototype.convertTo=function(e){var s=e.umod(this.m);return s===e?s.clone():s},z.prototype.convertFrom=function(e){var s=e.clone();return s.red=null,s},f.mont=function(e){return new Ct(e)};function Ct(p){z.call(this,p),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new f(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v(Ct,z),Ct.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},Ct.prototype.convertFrom=function(e){var s=this.imod(e.mul(this.rinv));return s.red=null,s},Ct.prototype.imul=function(e,s){if(e.isZero()||s.isZero())return e.words[0]=0,e.length=1,e;var a=e.imul(s),h=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=a.isub(h).iushrn(this.shift),g=d;return d.cmp(this.m)>=0?g=d.isub(this.m):d.cmpn(0)<0&&(g=d.iadd(this.m)),g._forceRed(this)},Ct.prototype.mul=function(e,s){if(e.isZero()||s.isZero())return new f(0)._forceRed(this);var a=e.mul(s),h=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=a.isub(h).iushrn(this.shift),g=d;return d.cmp(this.m)>=0?g=d.isub(this.m):d.cmpn(0)<0&&(g=d.iadd(this.m)),g._forceRed(this)},Ct.prototype.invm=function(e){var s=this.imod(e._invmp(this.m).mul(this.r2));return s._forceRed(this)}})(r,Cr)})(We);var yi=We.exports;const Mi=ir(yi);var bi=Ue;Ue.strict=lr;Ue.loose=fr;var _i=Object.prototype.toString,Si={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function Ue(r){return lr(r)||fr(r)}function lr(r){return r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Float32Array||r instanceof Float64Array}function fr(r){return Si[_i.call(r)]}var Ge=["buffer","Buffer"],ki=bi.strict,Ri=function(t){if(ki(t)){var i=Ge.from(t.buffer);return t.byteLength!==t.buffer.byteLength&&(i=i.slice(t.byteOffset,t.byteOffset+t.byteLength)),i}else return Ge.from(t)};const Oi=ir(Ri);var dr=["buffer","Buffer"];const pr="hex",gr="utf8",me="0";function ce(r){return new Uint8Array(r)}function mr(r,t=!1){const i=r.toString(pr);return t?le(i):i}function Ai(r){return r.toString(gr)}function ve(r){return Oi(r)}function ae(r,t=!1){return mr(ve(r),t)}function Ii(r){return Ai(ve(r))}function Ei(r){return dr.from(jt(r),pr)}function he(r){return ce(Ei(r))}function De(r){return dr.from(r,gr)}function Bi(r){return ce(De(r))}function Ti(r,t=!1){return mr(De(r),t)}function Ci(r,t){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/))}function vr(...r){let t=[];return r.forEach(i=>t=t.concat(Array.from(i))),new Uint8Array([...t])}function Ni(r,t=8){const i=r%t;return i?(r-i)/t*t+t:r}function Fi(r,t=8,i=me){return xi(r,Ni(r.length,t),i)}function xi(r,t,i=me){return Pi(r,t,!0,i)}function jt(r){return r.replace(/^0x/,"")}function le(r){return r.startsWith("0x")?r:`0x${r}`}function wr(r){return r=jt(r),r=Fi(r,2),r&&(r=le(r)),r}function qi(r){const t=r.startsWith("0x");return r=jt(r),r=r.startsWith(me)?r.substring(1):r,t?le(r):r}function Pi(r,t,i,c=me){const v=t-r.length;let f=r;return v>0&&(f=c.repeat(v)+r),f}function Ce(r){return ve(new Uint8Array(r))}function Li(r,t){return ae(new Uint8Array(r),!1)}function Wi(r){return ce(r).buffer}function Ui(r){return De(r)}function Di(r,t){return Ti(r,!0)}function ji(r){return he(r).buffer}function yr(r,t){const i=jt(wr(new Mi(r).toString(16)));return t?i:le(i)}var Mr={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(r){(function(){var t="input is invalid type",i="finalize already called",c=typeof window=="object",v=c?window:{};v.JS_SHA3_NO_WINDOW&&(c=!1);var f=!c&&typeof self=="object",N=!v.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;N?v=globalThis:f&&(v=self);var W=!v.JS_SHA3_NO_COMMON_JS&&!0&&r.exports,C=!v.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",D="0123456789abcdef".split(""),Rt=[31,7936,2031616,520093696],H=[4,1024,262144,67108864],Ot=[1,256,65536,16777216],At=[6,1536,393216,100663296],_t=[0,8,16,24],Tt=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],y=[224,256,384,512],S=[128,256],B=["hex","buffer","arrayBuffer","array","digest"],O={128:168,256:136};(v.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(o){return Object.prototype.toString.call(o)==="[object Array]"}),C&&(v.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(o){return typeof o=="object"&&o.buffer&&o.buffer.constructor===ArrayBuffer});for(var P=function(o,w,_){return function(M){return new R(o,w,o).update(M)[_]()}},St=function(o,w,_){return function(M,k){return new R(o,w,k).update(M)[_]()}},U=function(o,w,_){return function(M,k,x,I){return h["cshake"+o].update(M,k,x,I)[_]()}},Et=function(o,w,_){return function(M,k,x,I){return h["kmac"+o].update(M,k,x,I)[_]()}},z=function(o,w,_,M){for(var k=0;k<B.length;++k){var x=B[k];o[x]=w(_,M,x)}return o},Ct=function(o,w){var _=P(o,w,"hex");return _.create=function(){return new R(o,w,o)},_.update=function(M){return _.create().update(M)},z(_,P,o,w)},p=function(o,w){var _=St(o,w,"hex");return _.create=function(M){return new R(o,w,M)},_.update=function(M,k){return _.create(k).update(M)},z(_,St,o,w)},e=function(o,w){var _=O[o],M=U(o,w,"hex");return M.create=function(k,x,I){return!x&&!I?h["shake"+o].create(k):new R(o,w,k).bytepad([x,I],_)},M.update=function(k,x,I,A){return M.create(x,I,A).update(k)},z(M,U,o,w)},s=function(o,w){var _=O[o],M=Et(o,w,"hex");return M.create=function(k,x,I){return new F(o,w,x).bytepad(["KMAC",I],_).bytepad([k],_)},M.update=function(k,x,I,A){return M.create(k,I,A).update(x)},z(M,Et,o,w)},a=[{name:"keccak",padding:Ot,bits:y,createMethod:Ct},{name:"sha3",padding:At,bits:y,createMethod:Ct},{name:"shake",padding:Rt,bits:S,createMethod:p},{name:"cshake",padding:H,bits:S,createMethod:e},{name:"kmac",padding:H,bits:S,createMethod:s}],h={},d=[],g=0;g<a.length;++g)for(var m=a[g],u=m.bits,n=0;n<u.length;++n){var l=m.name+"_"+u[n];if(d.push(l),h[l]=m.createMethod(u[n],m.padding),m.name!=="sha3"){var T=m.name+u[n];d.push(T),h[T]=h[l]}}function R(o,w,_){this.blocks=[],this.s=[],this.padding=w,this.outputBits=_,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(o<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=_>>5,this.extraBytes=(_&31)>>3;for(var M=0;M<50;++M)this.s[M]=0}R.prototype.update=function(o){if(this.finalized)throw new Error(i);var w,_=typeof o;if(_!=="string"){if(_==="object"){if(o===null)throw new Error(t);if(C&&o.constructor===ArrayBuffer)o=new Uint8Array(o);else if(!Array.isArray(o)&&(!C||!ArrayBuffer.isView(o)))throw new Error(t)}else throw new Error(t);w=!0}for(var M=this.blocks,k=this.byteCount,x=o.length,I=this.blockCount,A=0,kt=this.s,E,L;A<x;){if(this.reset)for(this.reset=!1,M[0]=this.block,E=1;E<I+1;++E)M[E]=0;if(w)for(E=this.start;A<x&&E<k;++A)M[E>>2]|=o[A]<<_t[E++&3];else for(E=this.start;A<x&&E<k;++A)L=o.charCodeAt(A),L<128?M[E>>2]|=L<<_t[E++&3]:L<2048?(M[E>>2]|=(192|L>>6)<<_t[E++&3],M[E>>2]|=(128|L&63)<<_t[E++&3]):L<55296||L>=57344?(M[E>>2]|=(224|L>>12)<<_t[E++&3],M[E>>2]|=(128|L>>6&63)<<_t[E++&3],M[E>>2]|=(128|L&63)<<_t[E++&3]):(L=65536+((L&1023)<<10|o.charCodeAt(++A)&1023),M[E>>2]|=(240|L>>18)<<_t[E++&3],M[E>>2]|=(128|L>>12&63)<<_t[E++&3],M[E>>2]|=(128|L>>6&63)<<_t[E++&3],M[E>>2]|=(128|L&63)<<_t[E++&3]);if(this.lastByteIndex=E,E>=k){for(this.start=E-k,this.block=M[I],E=0;E<I;++E)kt[E]^=M[E];q(kt),this.reset=!0}else this.start=E}return this},R.prototype.encode=function(o,w){var _=o&255,M=1,k=[_];for(o=o>>8,_=o&255;_>0;)k.unshift(_),o=o>>8,_=o&255,++M;return w?k.push(M):k.unshift(M),this.update(k),k.length},R.prototype.encodeString=function(o){var w,_=typeof o;if(_!=="string"){if(_==="object"){if(o===null)throw new Error(t);if(C&&o.constructor===ArrayBuffer)o=new Uint8Array(o);else if(!Array.isArray(o)&&(!C||!ArrayBuffer.isView(o)))throw new Error(t)}else throw new Error(t);w=!0}var M=0,k=o.length;if(w)M=k;else for(var x=0;x<o.length;++x){var I=o.charCodeAt(x);I<128?M+=1:I<2048?M+=2:I<55296||I>=57344?M+=3:(I=65536+((I&1023)<<10|o.charCodeAt(++x)&1023),M+=4)}return M+=this.encode(M*8),this.update(o),M},R.prototype.bytepad=function(o,w){for(var _=this.encode(w),M=0;M<o.length;++M)_+=this.encodeString(o[M]);var k=w-_%w,x=[];return x.length=k,this.update(x),this},R.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var o=this.blocks,w=this.lastByteIndex,_=this.blockCount,M=this.s;if(o[w>>2]|=this.padding[w&3],this.lastByteIndex===this.byteCount)for(o[0]=o[_],w=1;w<_+1;++w)o[w]=0;for(o[_-1]|=2147483648,w=0;w<_;++w)M[w]^=o[w];q(M)}},R.prototype.toString=R.prototype.hex=function(){this.finalize();for(var o=this.blockCount,w=this.s,_=this.outputBlocks,M=this.extraBytes,k=0,x=0,I="",A;x<_;){for(k=0;k<o&&x<_;++k,++x)A=w[k],I+=D[A>>4&15]+D[A&15]+D[A>>12&15]+D[A>>8&15]+D[A>>20&15]+D[A>>16&15]+D[A>>28&15]+D[A>>24&15];x%o===0&&(q(w),k=0)}return M&&(A=w[k],I+=D[A>>4&15]+D[A&15],M>1&&(I+=D[A>>12&15]+D[A>>8&15]),M>2&&(I+=D[A>>20&15]+D[A>>16&15])),I},R.prototype.arrayBuffer=function(){this.finalize();var o=this.blockCount,w=this.s,_=this.outputBlocks,M=this.extraBytes,k=0,x=0,I=this.outputBits>>3,A;M?A=new ArrayBuffer(_+1<<2):A=new ArrayBuffer(I);for(var kt=new Uint32Array(A);x<_;){for(k=0;k<o&&x<_;++k,++x)kt[x]=w[k];x%o===0&&q(w)}return M&&(kt[k]=w[k],A=A.slice(0,I)),A},R.prototype.buffer=R.prototype.arrayBuffer,R.prototype.digest=R.prototype.array=function(){this.finalize();for(var o=this.blockCount,w=this.s,_=this.outputBlocks,M=this.extraBytes,k=0,x=0,I=[],A,kt;x<_;){for(k=0;k<o&&x<_;++k,++x)A=x<<2,kt=w[k],I[A]=kt&255,I[A+1]=kt>>8&255,I[A+2]=kt>>16&255,I[A+3]=kt>>24&255;x%o===0&&q(w)}return M&&(A=x<<2,kt=w[k],I[A]=kt&255,M>1&&(I[A+1]=kt>>8&255),M>2&&(I[A+2]=kt>>16&255)),I};function F(o,w,_){R.call(this,o,w,_)}F.prototype=new R,F.prototype.finalize=function(){return this.encode(this.outputBits,!0),R.prototype.finalize.call(this)};var q=function(o){var w,_,M,k,x,I,A,kt,E,L,zt,$,K,Vt,J,G,$t,Z,Q,Kt,X,Y,Jt,tt,et,Gt,rt,it,Zt,nt,st,Qt,ot,at,Xt,ht,ct,Yt,ut,lt,te,ft,dt,ee,pt,gt,re,mt,vt,ie,wt,yt,ne,Mt,bt,Nt,Ft,xt,qt,Pt,Lt,Wt,Ut;for(M=0;M<48;M+=2)k=o[0]^o[10]^o[20]^o[30]^o[40],x=o[1]^o[11]^o[21]^o[31]^o[41],I=o[2]^o[12]^o[22]^o[32]^o[42],A=o[3]^o[13]^o[23]^o[33]^o[43],kt=o[4]^o[14]^o[24]^o[34]^o[44],E=o[5]^o[15]^o[25]^o[35]^o[45],L=o[6]^o[16]^o[26]^o[36]^o[46],zt=o[7]^o[17]^o[27]^o[37]^o[47],$=o[8]^o[18]^o[28]^o[38]^o[48],K=o[9]^o[19]^o[29]^o[39]^o[49],w=$^(I<<1|A>>>31),_=K^(A<<1|I>>>31),o[0]^=w,o[1]^=_,o[10]^=w,o[11]^=_,o[20]^=w,o[21]^=_,o[30]^=w,o[31]^=_,o[40]^=w,o[41]^=_,w=k^(kt<<1|E>>>31),_=x^(E<<1|kt>>>31),o[2]^=w,o[3]^=_,o[12]^=w,o[13]^=_,o[22]^=w,o[23]^=_,o[32]^=w,o[33]^=_,o[42]^=w,o[43]^=_,w=I^(L<<1|zt>>>31),_=A^(zt<<1|L>>>31),o[4]^=w,o[5]^=_,o[14]^=w,o[15]^=_,o[24]^=w,o[25]^=_,o[34]^=w,o[35]^=_,o[44]^=w,o[45]^=_,w=kt^($<<1|K>>>31),_=E^(K<<1|$>>>31),o[6]^=w,o[7]^=_,o[16]^=w,o[17]^=_,o[26]^=w,o[27]^=_,o[36]^=w,o[37]^=_,o[46]^=w,o[47]^=_,w=L^(k<<1|x>>>31),_=zt^(x<<1|k>>>31),o[8]^=w,o[9]^=_,o[18]^=w,o[19]^=_,o[28]^=w,o[29]^=_,o[38]^=w,o[39]^=_,o[48]^=w,o[49]^=_,Vt=o[0],J=o[1],gt=o[11]<<4|o[10]>>>28,re=o[10]<<4|o[11]>>>28,it=o[20]<<3|o[21]>>>29,Zt=o[21]<<3|o[20]>>>29,Pt=o[31]<<9|o[30]>>>23,Lt=o[30]<<9|o[31]>>>23,ft=o[40]<<18|o[41]>>>14,dt=o[41]<<18|o[40]>>>14,at=o[2]<<1|o[3]>>>31,Xt=o[3]<<1|o[2]>>>31,G=o[13]<<12|o[12]>>>20,$t=o[12]<<12|o[13]>>>20,mt=o[22]<<10|o[23]>>>22,vt=o[23]<<10|o[22]>>>22,nt=o[33]<<13|o[32]>>>19,st=o[32]<<13|o[33]>>>19,Wt=o[42]<<2|o[43]>>>30,Ut=o[43]<<2|o[42]>>>30,Mt=o[5]<<30|o[4]>>>2,bt=o[4]<<30|o[5]>>>2,ht=o[14]<<6|o[15]>>>26,ct=o[15]<<6|o[14]>>>26,Z=o[25]<<11|o[24]>>>21,Q=o[24]<<11|o[25]>>>21,ie=o[34]<<15|o[35]>>>17,wt=o[35]<<15|o[34]>>>17,Qt=o[45]<<29|o[44]>>>3,ot=o[44]<<29|o[45]>>>3,tt=o[6]<<28|o[7]>>>4,et=o[7]<<28|o[6]>>>4,Nt=o[17]<<23|o[16]>>>9,Ft=o[16]<<23|o[17]>>>9,Yt=o[26]<<25|o[27]>>>7,ut=o[27]<<25|o[26]>>>7,Kt=o[36]<<21|o[37]>>>11,X=o[37]<<21|o[36]>>>11,yt=o[47]<<24|o[46]>>>8,ne=o[46]<<24|o[47]>>>8,ee=o[8]<<27|o[9]>>>5,pt=o[9]<<27|o[8]>>>5,Gt=o[18]<<20|o[19]>>>12,rt=o[19]<<20|o[18]>>>12,xt=o[29]<<7|o[28]>>>25,qt=o[28]<<7|o[29]>>>25,lt=o[38]<<8|o[39]>>>24,te=o[39]<<8|o[38]>>>24,Y=o[48]<<14|o[49]>>>18,Jt=o[49]<<14|o[48]>>>18,o[0]=Vt^~G&Z,o[1]=J^~$t&Q,o[10]=tt^~Gt&it,o[11]=et^~rt&Zt,o[20]=at^~ht&Yt,o[21]=Xt^~ct&ut,o[30]=ee^~gt&mt,o[31]=pt^~re&vt,o[40]=Mt^~Nt&xt,o[41]=bt^~Ft&qt,o[2]=G^~Z&Kt,o[3]=$t^~Q&X,o[12]=Gt^~it&nt,o[13]=rt^~Zt&st,o[22]=ht^~Yt&lt,o[23]=ct^~ut&te,o[32]=gt^~mt&ie,o[33]=re^~vt&wt,o[42]=Nt^~xt&Pt,o[43]=Ft^~qt&Lt,o[4]=Z^~Kt&Y,o[5]=Q^~X&Jt,o[14]=it^~nt&Qt,o[15]=Zt^~st&ot,o[24]=Yt^~lt&ft,o[25]=ut^~te&dt,o[34]=mt^~ie&yt,o[35]=vt^~wt&ne,o[44]=xt^~Pt&Wt,o[45]=qt^~Lt&Ut,o[6]=Kt^~Y&Vt,o[7]=X^~Jt&J,o[16]=nt^~Qt&tt,o[17]=st^~ot&et,o[26]=lt^~ft&at,o[27]=te^~dt&Xt,o[36]=ie^~yt&ee,o[37]=wt^~ne&pt,o[46]=Pt^~Wt&Mt,o[47]=Lt^~Ut&bt,o[8]=Y^~Vt&G,o[9]=Jt^~J&$t,o[18]=Qt^~tt&Gt,o[19]=ot^~et&rt,o[28]=ft^~at&ht,o[29]=dt^~Xt&ct,o[38]=yt^~ee&gt,o[39]=ne^~pt&re,o[48]=Wt^~Mt&Nt,o[49]=Ut^~bt&Ft,o[0]^=Tt[M],o[1]^=Tt[M+1]};if(W)r.exports=h;else for(g=0;g<d.length;++g)v[d[g]]=h[d[g]]})()})(Mr);var Hi=Mr.exports;function pe(r){return wr(r)}function zi(r){return qi(le(r))}const Vi=Nr;function Ee(){return((t,i)=>{for(i=t="";t++<36;i+=t*51&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-");return i})()}function $i(r){return r===""||typeof r=="string"&&r.trim()===""}function Ki(r){return!(r&&r.length)}function br(r,t){return Ci(r)}function Ji(r){return typeof r.method<"u"}function fe(r){return typeof r.result<"u"}function ge(r){return typeof r.error<"u"}function Ze(r){return typeof r.event<"u"}function Gi(r){return wi.includes(r)||r.startsWith("wc_")}function Zi(r){return r.method.startsWith("wc_")?!0:!ur.includes(r.method)}function Qi(r){r=jt(r.toLowerCase());const t=jt(Hi.keccak_256(Ui(r)));let i="";for(let c=0;c<r.length;c++)parseInt(t[c],16)>7?i+=r[c].toUpperCase():i+=r[c];return le(i)}const Xi=r=>r?r.toLowerCase().substring(0,2)!=="0x"?!1:/^(0x)?[0-9a-f]{40}$/i.test(r)?/^(0x)?[0-9a-f]{40}$/.test(r)||/^(0x)?[0-9A-F]{40}$/.test(r)?!0:r===Qi(r):!1:!1;function Qe(r){return!Ki(r)&&!br(r[0])&&(r[0]=Di(r[0])),r}function Be(r){if(typeof r.type<"u"&&r.type!=="0")return r;if(typeof r.from>"u"||!Xi(r.from))throw new Error("Transaction object must include a valid 'from' value.");function t(v){let f=v;return(typeof v=="number"||typeof v=="string"&&!$i(v))&&(br(v)?typeof v=="string"&&(f=pe(v)):f=yr(v)),typeof f=="string"&&(f=zi(f)),f}const i={from:pe(r.from),to:typeof r.to>"u"?void 0:pe(r.to),gasPrice:typeof r.gasPrice>"u"?"":t(r.gasPrice),gas:typeof r.gas>"u"?typeof r.gasLimit>"u"?"":t(r.gasLimit):t(r.gas),value:typeof r.value>"u"?"":t(r.value),nonce:typeof r.nonce>"u"?"":t(r.nonce),data:typeof r.data>"u"?"":pe(r.data)||"0x"},c=["gasPrice","gas","value","nonce"];return Object.keys(i).forEach(v=>{(typeof i[v]>"u"||typeof i[v]=="string"&&!i[v].trim().length)&&c.includes(v)&&delete i[v]}),i}function Yi(r){const t=r.message||"Failed or Rejected Request";let i=-32e3;if(r&&!r.code)switch(t){case"Parse error":i=-32700;break;case"Invalid request":i=-32600;break;case"Method not found":i=-32601;break;case"Invalid params":i=-32602;break;case"Internal error":i=-32603;break;default:i=-32e3;break}const c={code:i,message:t};return r.data&&(c.data=r.data),c}var je={},tn=r=>encodeURIComponent(r).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),_r="%[a-f0-9]{2}",Xe=new RegExp("("+_r+")|([^%]+?)","gi"),Ye=new RegExp("("+_r+")+","gi");function Ne(r,t){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;t=t||1;var i=r.slice(0,t),c=r.slice(t);return Array.prototype.concat.call([],Ne(i),Ne(c))}function en(r){try{return decodeURIComponent(r)}catch{for(var t=r.match(Xe)||[],i=1;i<t.length;i++)r=Ne(t,i).join(""),t=r.match(Xe)||[];return r}}function rn(r){for(var t={"%FE%FF":"","%FF%FE":""},i=Ye.exec(r);i;){try{t[i[0]]=decodeURIComponent(i[0])}catch{var c=en(i[0]);c!==i[0]&&(t[i[0]]=c)}i=Ye.exec(r)}t["%C2"]="";for(var v=Object.keys(t),f=0;f<v.length;f++){var N=v[f];r=r.replace(new RegExp(N,"g"),t[N])}return r}var nn=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return rn(r)}},sn=(r,t)=>{if(!(typeof r=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[r];const i=r.indexOf(t);return i===-1?[r]:[r.slice(0,i),r.slice(i+t.length)]};(function(r){const t=tn,i=nn,c=sn,v=y=>y==null;function f(y){switch(y.arrayFormat){case"index":return S=>(B,O)=>{const P=B.length;return O===void 0||y.skipNull&&O===null||y.skipEmptyString&&O===""?B:O===null?[...B,[C(S,y),"[",P,"]"].join("")]:[...B,[C(S,y),"[",C(P,y),"]=",C(O,y)].join("")]};case"bracket":return S=>(B,O)=>O===void 0||y.skipNull&&O===null||y.skipEmptyString&&O===""?B:O===null?[...B,[C(S,y),"[]"].join("")]:[...B,[C(S,y),"[]=",C(O,y)].join("")];case"comma":case"separator":return S=>(B,O)=>O==null||O.length===0?B:B.length===0?[[C(S,y),"=",C(O,y)].join("")]:[[B,C(O,y)].join(y.arrayFormatSeparator)];default:return S=>(B,O)=>O===void 0||y.skipNull&&O===null||y.skipEmptyString&&O===""?B:O===null?[...B,C(S,y)]:[...B,[C(S,y),"=",C(O,y)].join("")]}}function N(y){let S;switch(y.arrayFormat){case"index":return(B,O,P)=>{if(S=/\[(\d*)\]$/.exec(B),B=B.replace(/\[\d*\]$/,""),!S){P[B]=O;return}P[B]===void 0&&(P[B]={}),P[B][S[1]]=O};case"bracket":return(B,O,P)=>{if(S=/(\[\])$/.exec(B),B=B.replace(/\[\]$/,""),!S){P[B]=O;return}if(P[B]===void 0){P[B]=[O];return}P[B]=[].concat(P[B],O)};case"comma":case"separator":return(B,O,P)=>{const U=typeof O=="string"&&O.split("").indexOf(y.arrayFormatSeparator)>-1?O.split(y.arrayFormatSeparator).map(Et=>D(Et,y)):O===null?O:D(O,y);P[B]=U};default:return(B,O,P)=>{if(P[B]===void 0){P[B]=O;return}P[B]=[].concat(P[B],O)}}}function W(y){if(typeof y!="string"||y.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function C(y,S){return S.encode?S.strict?t(y):encodeURIComponent(y):y}function D(y,S){return S.decode?i(y):y}function Rt(y){return Array.isArray(y)?y.sort():typeof y=="object"?Rt(Object.keys(y)).sort((S,B)=>Number(S)-Number(B)).map(S=>y[S]):y}function H(y){const S=y.indexOf("#");return S!==-1&&(y=y.slice(0,S)),y}function Ot(y){let S="";const B=y.indexOf("#");return B!==-1&&(S=y.slice(B)),S}function At(y){y=H(y);const S=y.indexOf("?");return S===-1?"":y.slice(S+1)}function _t(y,S){return S.parseNumbers&&!Number.isNaN(Number(y))&&typeof y=="string"&&y.trim()!==""?y=Number(y):S.parseBooleans&&y!==null&&(y.toLowerCase()==="true"||y.toLowerCase()==="false")&&(y=y.toLowerCase()==="true"),y}function Tt(y,S){S=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},S),W(S.arrayFormatSeparator);const B=N(S),O=Object.create(null);if(typeof y!="string"||(y=y.trim().replace(/^[?#&]/,""),!y))return O;for(const P of y.split("&")){let[St,U]=c(S.decode?P.replace(/\+/g," "):P,"=");U=U===void 0?null:["comma","separator"].includes(S.arrayFormat)?U:D(U,S),B(D(St,S),U,O)}for(const P of Object.keys(O)){const St=O[P];if(typeof St=="object"&&St!==null)for(const U of Object.keys(St))St[U]=_t(St[U],S);else O[P]=_t(St,S)}return S.sort===!1?O:(S.sort===!0?Object.keys(O).sort():Object.keys(O).sort(S.sort)).reduce((P,St)=>{const U=O[St];return U&&typeof U=="object"&&!Array.isArray(U)?P[St]=Rt(U):P[St]=U,P},Object.create(null))}r.extract=At,r.parse=Tt,r.stringify=(y,S)=>{if(!y)return"";S=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},S),W(S.arrayFormatSeparator);const B=U=>S.skipNull&&v(y[U])||S.skipEmptyString&&y[U]==="",O=f(S),P={};for(const U of Object.keys(y))B(U)||(P[U]=y[U]);const St=Object.keys(P);return S.sort!==!1&&St.sort(S.sort),St.map(U=>{const Et=y[U];return Et===void 0?"":Et===null?C(U,S):Array.isArray(Et)?Et.reduce(O(U),[]).join("&"):C(U,S)+"="+C(Et,S)}).filter(U=>U.length>0).join("&")},r.parseUrl=(y,S)=>{S=Object.assign({decode:!0},S);const[B,O]=c(y,"#");return Object.assign({url:B.split("?")[0]||"",query:Tt(At(y),S)},S&&S.parseFragmentIdentifier&&O?{fragmentIdentifier:D(O,S)}:{})},r.stringifyUrl=(y,S)=>{S=Object.assign({encode:!0,strict:!0},S);const B=H(y.url).split("?")[0]||"",O=r.extract(y.url),P=r.parse(O,{sort:!1}),St=Object.assign(P,y.query);let U=r.stringify(St,S);U&&(U=`?${U}`);let Et=Ot(y.url);return y.fragmentIdentifier&&(Et=`#${C(y.fragmentIdentifier,S)}`),`${B}${U}${Et}`}})(je);function on(r){const t=r.indexOf("?")!==-1?r.indexOf("?"):void 0;return typeof t<"u"?r.substr(t):""}function an(r,t){let i=Sr(r);return i=Object.assign(Object.assign({},i),t),r=hn(i),r}function Sr(r){return je.parse(r)}function hn(r){return je.stringify(r)}function cn(r){return typeof r.bridge<"u"}function un(r){const t=r.indexOf(":"),i=r.indexOf("?")!==-1?r.indexOf("?"):void 0,c=r.substring(0,t),v=r.substring(t+1,i);function f(H){const At=H.split("@");return{handshakeTopic:At[0],version:parseInt(At[1],10)}}const N=f(v),W=typeof i<"u"?r.substr(i):"";function C(H){const Ot=Sr(H);return{key:Ot.key||"",bridge:Ot.bridge||""}}const D=C(W);return Object.assign(Object.assign({protocol:c},N),D)}class ln{constructor(){this._eventEmitters=[],typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",()=>this.trigger("online")),window.addEventListener("offline",()=>this.trigger("offline")))}on(t,i){this._eventEmitters.push({event:t,callback:i})}trigger(t){let i=[];t&&(i=this._eventEmitters.filter(c=>c.event===t)),i.forEach(c=>{c.callback()})}}const fn=typeof globalThis.WebSocket<"u"?globalThis.WebSocket:require("ws");class dn{constructor(t){if(this.opts=t,this._queue=[],this._events=[],this._subscriptions=[],this._protocol=t.protocol,this._version=t.version,this._url="",this._netMonitor=null,this._socket=null,this._nextSocket=null,this._subscriptions=t.subscriptions||[],this._netMonitor=t.netMonitor||new ln,!t.url||typeof t.url!="string")throw new Error("Missing or invalid WebSocket url");this._url=t.url,this._netMonitor.on("online",()=>this._socketCreate())}set readyState(t){}get readyState(){return this._socket?this._socket.readyState:-1}set connecting(t){}get connecting(){return this.readyState===0}set connected(t){}get connected(){return this.readyState===1}set closing(t){}get closing(){return this.readyState===2}set closed(t){}get closed(){return this.readyState===3}open(){this._socketCreate()}close(){this._socketClose()}send(t,i,c){if(!i||typeof i!="string")throw new Error("Missing or invalid topic field");this._socketSend({topic:i,type:"pub",payload:t,silent:!!c})}subscribe(t){this._socketSend({topic:t,type:"sub",payload:"",silent:!0})}on(t,i){this._events.push({event:t,callback:i})}_socketCreate(){if(this._nextSocket)return;const t=pn(this._url,this._protocol,this._version);if(this._nextSocket=new fn(t),!this._nextSocket)throw new Error("Failed to create socket");this._nextSocket.onmessage=i=>this._socketReceive(i),this._nextSocket.onopen=()=>this._socketOpen(),this._nextSocket.onerror=i=>this._socketError(i),this._nextSocket.onclose=()=>{setTimeout(()=>{this._nextSocket=null,this._socketCreate()},1e3)}}_socketOpen(){this._socketClose(),this._socket=this._nextSocket,this._nextSocket=null,this._queueSubscriptions(),this._pushQueue()}_socketClose(){this._socket&&(this._socket.onclose=()=>{},this._socket.close())}_socketSend(t){const i=JSON.stringify(t);this._socket&&this._socket.readyState===1?this._socket.send(i):(this._setToQueue(t),this._socketCreate())}async _socketReceive(t){let i;try{i=JSON.parse(t.data)}catch{return}if(this._socketSend({topic:i.topic,type:"ack",payload:"",silent:!0}),this._socket&&this._socket.readyState===1){const c=this._events.filter(v=>v.event==="message");c&&c.length&&c.forEach(v=>v.callback(i))}}_socketError(t){const i=this._events.filter(c=>c.event==="error");i&&i.length&&i.forEach(c=>c.callback(t))}_queueSubscriptions(){this._subscriptions.forEach(i=>this._queue.push({topic:i,type:"sub",payload:"",silent:!0})),this._subscriptions=this.opts.subscriptions||[]}_setToQueue(t){this._queue.push(t)}_pushQueue(){this._queue.forEach(i=>this._socketSend(i)),this._queue=[]}}function pn(r,t,i){var c,v;const N=(r.startsWith("https")?r.replace("https","wss"):r.startsWith("http")?r.replace("http","ws"):r).split("?"),W=ui()?{protocol:t,version:i,env:"browser",host:((c=fi())===null||c===void 0?void 0:c.host)||""}:{protocol:t,version:i,env:((v=qe())===null||v===void 0?void 0:v.name)||""},C=an(on(N[1]||""),W);return N[0]+"?"+C}const Te="Session currently connected",se="Session currently disconnected",gn="Session Rejected",mn="Missing JSON RPC response",vn='JSON-RPC success response must include "result" field',wn='JSON-RPC error response must include "error" field',yn='JSON RPC request must have valid "method" value',Mn='JSON RPC request must have valid "id" value',bn="Missing one of the required parameters: bridge / uri / session",tr="JSON RPC response format is invalid",_n="URI format is invalid",Sn="QRCode Modal not provided",er="User close QRCode Modal";class kn{constructor(){this._eventEmitters=[]}subscribe(t){this._eventEmitters.push(t)}unsubscribe(t){this._eventEmitters=this._eventEmitters.filter(i=>i.event!==t)}trigger(t){let i=[],c;Ji(t)?c=t.method:fe(t)||ge(t)?c=`response:${t.id}`:Ze(t)?c=t.event:c="",c&&(i=this._eventEmitters.filter(v=>v.event===c)),(!i||!i.length)&&!Gi(c)&&!Ze(c)&&(i=this._eventEmitters.filter(v=>v.event==="call_request")),i.forEach(v=>{if(ge(t)){const f=new Error(t.error.message);v.callback(f,null)}else v.callback(null,t)})}}class Rn{constructor(t="walletconnect"){this.storageId=t}getSession(){let t=null;const i=hr(this.storageId);return i&&cn(i)&&(t=i),t}setSession(t){return vi(this.storageId,t),t}removeSession(){cr(this.storageId)}}const On="walletconnect.org",An="abcdefghijklmnopqrstuvwxyz0123456789",kr=An.split("").map(r=>`https://${r}.bridge.walletconnect.org`);function In(r){let t=r.indexOf("//")>-1?r.split("/")[2]:r.split("/")[0];return t=t.split(":")[0],t=t.split("?")[0],t}function En(r){return In(r).split(".").slice(-2).join(".")}function Bn(){return Math.floor(Math.random()*kr.length)}function Tn(){return kr[Bn()]}function Cn(r){return En(r)===On}function Nn(r){return Cn(r)?Tn():r}class Fn{constructor(t){if(this.protocol="wc",this.version=1,this._bridge="",this._key=null,this._clientId="",this._clientMeta=null,this._peerId="",this._peerMeta=null,this._handshakeId=0,this._handshakeTopic="",this._connected=!1,this._accounts=[],this._chainId=0,this._networkId=0,this._rpcUrl="",this._eventManager=new kn,this._clientMeta=Ke()||t.connectorOpts.clientMeta||null,this._cryptoLib=t.cryptoLib,this._sessionStorage=t.sessionStorage||new Rn(t.connectorOpts.storageId),this._qrcodeModal=t.connectorOpts.qrcodeModal,this._qrcodeModalOptions=t.connectorOpts.qrcodeModalOptions,this._signingMethods=[...ur,...t.connectorOpts.signingMethods||[]],!t.connectorOpts.bridge&&!t.connectorOpts.uri&&!t.connectorOpts.session)throw new Error(bn);t.connectorOpts.bridge&&(this.bridge=Nn(t.connectorOpts.bridge)),t.connectorOpts.uri&&(this.uri=t.connectorOpts.uri);const i=t.connectorOpts.session||this._getStorageSession();i&&(this.session=i),this.handshakeId&&this._subscribeToSessionResponse(this.handshakeId,"Session request rejected"),this._transport=t.transport||new dn({protocol:this.protocol,version:this.version,url:this.bridge,subscriptions:[this.clientId]}),this._subscribeToInternalEvents(),this._initTransport(),t.connectorOpts.uri&&this._subscribeToSessionRequest(),t.pushServerOpts&&this._registerPushServer(t.pushServerOpts)}set bridge(t){t&&(this._bridge=t)}get bridge(){return this._bridge}set key(t){if(!t)return;const i=ji(t);this._key=i}get key(){return this._key?Li(this._key):""}set clientId(t){t&&(this._clientId=t)}get clientId(){let t=this._clientId;return t||(t=this._clientId=Ee()),this._clientId}set peerId(t){t&&(this._peerId=t)}get peerId(){return this._peerId}set clientMeta(t){}get clientMeta(){let t=this._clientMeta;return t||(t=this._clientMeta=Ke()),t}set peerMeta(t){this._peerMeta=t}get peerMeta(){return this._peerMeta}set handshakeTopic(t){t&&(this._handshakeTopic=t)}get handshakeTopic(){return this._handshakeTopic}set handshakeId(t){t&&(this._handshakeId=t)}get handshakeId(){return this._handshakeId}get uri(){return this._formatUri()}set uri(t){if(!t)return;const{handshakeTopic:i,bridge:c,key:v}=this._parseUri(t);this.handshakeTopic=i,this.bridge=c,this.key=v}set chainId(t){this._chainId=t}get chainId(){return this._chainId}set networkId(t){this._networkId=t}get networkId(){return this._networkId}set accounts(t){this._accounts=t}get accounts(){return this._accounts}set rpcUrl(t){this._rpcUrl=t}get rpcUrl(){return this._rpcUrl}set connected(t){}get connected(){return this._connected}set pending(t){}get pending(){return!!this._handshakeTopic}get session(){return{connected:this.connected,accounts:this.accounts,chainId:this.chainId,bridge:this.bridge,key:this.key,clientId:this.clientId,clientMeta:this.clientMeta,peerId:this.peerId,peerMeta:this.peerMeta,handshakeId:this.handshakeId,handshakeTopic:this.handshakeTopic}}set session(t){t&&(this._connected=t.connected,this.accounts=t.accounts,this.chainId=t.chainId,this.bridge=t.bridge,this.key=t.key,this.clientId=t.clientId,this.clientMeta=t.clientMeta,this.peerId=t.peerId,this.peerMeta=t.peerMeta,this.handshakeId=t.handshakeId,this.handshakeTopic=t.handshakeTopic)}on(t,i){const c={event:t,callback:i};this._eventManager.subscribe(c)}off(t){this._eventManager.unsubscribe(t)}async createInstantRequest(t){this._key=await this._generateKey();const i=this._formatRequest({method:"wc_instantRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,request:this._formatRequest(t)}]});this.handshakeId=i.id,this.handshakeTopic=Ee(),this._eventManager.trigger({event:"display_uri",params:[this.uri]}),this.on("modal_closed",()=>{throw new Error(er)});const c=()=>{this.killSession()};try{const v=await this._sendCallRequest(i);return v&&c(),v}catch(v){throw c(),v}}async connect(t){if(!this._qrcodeModal)throw new Error(Sn);return this.connected?{chainId:this.chainId,accounts:this.accounts}:(await this.createSession(t),new Promise(async(i,c)=>{this.on("modal_closed",()=>c(new Error(er))),this.on("connect",(v,f)=>{if(v)return c(v);i(f.params[0])})}))}async createSession(t){if(this._connected)throw new Error(Te);if(this.pending)return;this._key=await this._generateKey();const i=this._formatRequest({method:"wc_sessionRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,chainId:t&&t.chainId?t.chainId:null}]});this.handshakeId=i.id,this.handshakeTopic=Ee(),this._sendSessionRequest(i,"Session update rejected",{topic:this.handshakeTopic}),this._eventManager.trigger({event:"display_uri",params:[this.uri]})}approveSession(t){if(this._connected)throw new Error(Te);this.chainId=t.chainId,this.accounts=t.accounts,this.networkId=t.networkId||0,this.rpcUrl=t.rpcUrl||"";const i={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl,peerId:this.clientId,peerMeta:this.clientMeta},c={id:this.handshakeId,jsonrpc:"2.0",result:i};this._sendResponse(c),this._connected=!0,this._setStorageSession(),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})}rejectSession(t){if(this._connected)throw new Error(Te);const i=t&&t.message?t.message:gn,c=this._formatResponse({id:this.handshakeId,error:{message:i}});this._sendResponse(c),this._connected=!1,this._eventManager.trigger({event:"disconnect",params:[{message:i}]}),this._removeStorageSession()}updateSession(t){if(!this._connected)throw new Error(se);this.chainId=t.chainId,this.accounts=t.accounts,this.networkId=t.networkId||0,this.rpcUrl=t.rpcUrl||"";const i={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl},c=this._formatRequest({method:"wc_sessionUpdate",params:[i]});this._sendSessionRequest(c,"Session update rejected"),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]}),this._manageStorageSession()}async killSession(t){const i=t?t.message:"Session Disconnected",c={approved:!1,chainId:null,networkId:null,accounts:null},v=this._formatRequest({method:"wc_sessionUpdate",params:[c]});await this._sendRequest(v),this._handleSessionDisconnect(i)}async sendTransaction(t){if(!this._connected)throw new Error(se);const i=Be(t),c=this._formatRequest({method:"eth_sendTransaction",params:[i]});return await this._sendCallRequest(c)}async signTransaction(t){if(!this._connected)throw new Error(se);const i=Be(t),c=this._formatRequest({method:"eth_signTransaction",params:[i]});return await this._sendCallRequest(c)}async signMessage(t){if(!this._connected)throw new Error(se);const i=this._formatRequest({method:"eth_sign",params:t});return await this._sendCallRequest(i)}async signPersonalMessage(t){if(!this._connected)throw new Error(se);t=Qe(t);const i=this._formatRequest({method:"personal_sign",params:t});return await this._sendCallRequest(i)}async signTypedData(t){if(!this._connected)throw new Error(se);const i=this._formatRequest({method:"eth_signTypedData",params:t});return await this._sendCallRequest(i)}async updateChain(t){if(!this._connected)throw new Error("Session currently disconnected");const i=this._formatRequest({method:"wallet_updateChain",params:[t]});return await this._sendCallRequest(i)}unsafeSend(t,i){return this._sendRequest(t,i),this._eventManager.trigger({event:"call_request_sent",params:[{request:t,options:i}]}),new Promise((c,v)=>{this._subscribeToResponse(t.id,(f,N)=>{if(f){v(f);return}if(!N)throw new Error(mn);c(N)})})}async sendCustomRequest(t,i){if(!this._connected)throw new Error(se);switch(t.method){case"eth_accounts":return this.accounts;case"eth_chainId":return yr(this.chainId);case"eth_sendTransaction":case"eth_signTransaction":t.params&&(t.params[0]=Be(t.params[0]));break;case"personal_sign":t.params&&(t.params=Qe(t.params));break}const c=this._formatRequest(t);return await this._sendCallRequest(c,i)}approveRequest(t){if(fe(t)){const i=this._formatResponse(t);this._sendResponse(i)}else throw new Error(vn)}rejectRequest(t){if(ge(t)){const i=this._formatResponse(t);this._sendResponse(i)}else throw new Error(wn)}transportClose(){this._transport.close()}async _sendRequest(t,i){const c=this._formatRequest(t),v=await this._encrypt(c),f=typeof(i==null?void 0:i.topic)<"u"?i.topic:this.peerId,N=JSON.stringify(v),W=typeof(i==null?void 0:i.forcePushNotification)<"u"?!i.forcePushNotification:Zi(c);this._transport.send(N,f,W)}async _sendResponse(t){const i=await this._encrypt(t),c=this.peerId,v=JSON.stringify(i);this._transport.send(v,c,!0)}async _sendSessionRequest(t,i,c){this._sendRequest(t,c),this._subscribeToSessionResponse(t.id,i)}_sendCallRequest(t,i){return this._sendRequest(t,i),this._eventManager.trigger({event:"call_request_sent",params:[{request:t,options:i}]}),this._subscribeToCallResponse(t.id)}_formatRequest(t){if(typeof t.method>"u")throw new Error(yn);return{id:typeof t.id>"u"?Vi():t.id,jsonrpc:"2.0",method:t.method,params:typeof t.params>"u"?[]:t.params}}_formatResponse(t){if(typeof t.id>"u")throw new Error(Mn);const i={id:t.id,jsonrpc:"2.0"};if(ge(t)){const c=Yi(t.error);return Object.assign(Object.assign(Object.assign({},i),t),{error:c})}else if(fe(t))return Object.assign(Object.assign({},i),t);throw new Error(tr)}_handleSessionDisconnect(t){const i=t||"Session Disconnected";this._connected||(this._qrcodeModal&&this._qrcodeModal.close(),cr(Je)),this._connected&&(this._connected=!1),this._handshakeId&&(this._handshakeId=0),this._handshakeTopic&&(this._handshakeTopic=""),this._peerId&&(this._peerId=""),this._eventManager.trigger({event:"disconnect",params:[{message:i}]}),this._removeStorageSession(),this.transportClose()}_handleSessionResponse(t,i){i?i.approved?(this._connected?(i.chainId&&(this.chainId=i.chainId),i.accounts&&(this.accounts=i.accounts),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]})):(this._connected=!0,i.chainId&&(this.chainId=i.chainId),i.accounts&&(this.accounts=i.accounts),i.peerId&&!this.peerId&&(this.peerId=i.peerId),i.peerMeta&&!this.peerMeta&&(this.peerMeta=i.peerMeta),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})),this._manageStorageSession()):this._handleSessionDisconnect(t):this._handleSessionDisconnect(t)}async _handleIncomingMessages(t){if(![this.clientId,this.handshakeTopic].includes(t.topic))return;let c;try{c=JSON.parse(t.payload)}catch{return}const v=await this._decrypt(c);v&&this._eventManager.trigger(v)}_subscribeToSessionRequest(){this._transport.subscribe(this.handshakeTopic)}_subscribeToResponse(t,i){this.on(`response:${t}`,i)}_subscribeToSessionResponse(t,i){this._subscribeToResponse(t,(c,v)=>{if(c){this._handleSessionResponse(c.message);return}fe(v)?this._handleSessionResponse(i,v.result):v.error&&v.error.message?this._handleSessionResponse(v.error.message):this._handleSessionResponse(i)})}_subscribeToCallResponse(t){return new Promise((i,c)=>{this._subscribeToResponse(t,(v,f)=>{if(v){c(v);return}fe(f)?i(f.result):f.error&&f.error.message?c(f.error):c(new Error(tr))})})}_subscribeToInternalEvents(){this.on("display_uri",()=>{this._qrcodeModal&&this._qrcodeModal.open(this.uri,()=>{this._eventManager.trigger({event:"modal_closed",params:[]})},this._qrcodeModalOptions)}),this.on("connect",()=>{this._qrcodeModal&&this._qrcodeModal.close()}),this.on("call_request_sent",(t,i)=>{const{request:c}=i.params[0];if(hi()&&this._signingMethods.includes(c.method)){const v=hr(Je);v&&(window.location.href=v.href)}}),this.on("wc_sessionRequest",(t,i)=>{t&&this._eventManager.trigger({event:"error",params:[{code:"SESSION_REQUEST_ERROR",message:t.toString()}]}),this.handshakeId=i.id,this.peerId=i.params[0].peerId,this.peerMeta=i.params[0].peerMeta;const c=Object.assign(Object.assign({},i),{method:"session_request"});this._eventManager.trigger(c)}),this.on("wc_sessionUpdate",(t,i)=>{t&&this._handleSessionResponse(t.message),this._handleSessionResponse("Session disconnected",i.params[0])})}_initTransport(){this._transport.on("message",t=>this._handleIncomingMessages(t)),this._transport.on("open",()=>this._eventManager.trigger({event:"transport_open",params:[]})),this._transport.on("close",()=>this._eventManager.trigger({event:"transport_close",params:[]})),this._transport.on("error",()=>this._eventManager.trigger({event:"transport_error",params:["Websocket connection failed"]})),this._transport.open()}_formatUri(){const t=this.protocol,i=this.handshakeTopic,c=this.version,v=encodeURIComponent(this.bridge),f=this.key;return`${t}:${i}@${c}?bridge=${v}&key=${f}`}_parseUri(t){const i=un(t);if(i.protocol===this.protocol){if(!i.handshakeTopic)throw Error("Invalid or missing handshakeTopic parameter value");const c=i.handshakeTopic;if(!i.bridge)throw Error("Invalid or missing bridge url parameter value");const v=decodeURIComponent(i.bridge);if(!i.key)throw Error("Invalid or missing key parameter value");const f=i.key;return{handshakeTopic:c,bridge:v,key:f}}else throw new Error(_n)}async _generateKey(){return this._cryptoLib?await this._cryptoLib.generateKey():null}async _encrypt(t){const i=this._key;return this._cryptoLib&&i?await this._cryptoLib.encrypt(t,i):null}async _decrypt(t){const i=this._key;return this._cryptoLib&&i?await this._cryptoLib.decrypt(t,i):null}_getStorageSession(){let t=null;return this._sessionStorage&&(t=this._sessionStorage.getSession()),t}_setStorageSession(){this._sessionStorage&&this._sessionStorage.setSession(this.session)}_removeStorageSession(){this._sessionStorage&&this._sessionStorage.removeSession()}_manageStorageSession(){this._connected?this._setStorageSession():this._removeStorageSession()}_registerPushServer(t){if(!t.url||typeof t.url!="string")throw Error("Invalid or missing pushServerOpts.url parameter value");if(!t.type||typeof t.type!="string")throw Error("Invalid or missing pushServerOpts.type parameter value");if(!t.token||typeof t.token!="string")throw Error("Invalid or missing pushServerOpts.token parameter value");const i={bridge:this.bridge,topic:this.clientId,type:t.type,token:t.token,peerName:"",language:t.language||""};this.on("connect",async(c,v)=>{if(c)throw c;if(t.peerMeta){const f=v.params[0].peerMeta.name;i.peerName=f}try{if(!(await(await fetch(`${t.url}/new`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)})).json()).success)throw Error("Failed to register in Push Server")}catch{throw Error("Failed to register in Push Server")}})}}function xn(r){return de.getBrowerCrypto().getRandomValues(new Uint8Array(r))}const Rr=256,Or=Rr,qn=Rr,Ht="AES-CBC",Pn=`SHA-${Or}`,Fe="HMAC",Ln="encrypt",Wn="decrypt",Un="sign",Dn="verify";function jn(r){return r===Ht?{length:Or,name:Ht}:{hash:{name:Pn},name:Fe}}function Hn(r){return r===Ht?[Ln,Wn]:[Un,Dn]}async function He(r,t=Ht){return de.getSubtleCrypto().importKey("raw",r,jn(t),!0,Hn(t))}async function zn(r,t,i){const c=de.getSubtleCrypto(),v=await He(t,Ht),f=await c.encrypt({iv:r,name:Ht},v,i);return new Uint8Array(f)}async function Vn(r,t,i){const c=de.getSubtleCrypto(),v=await He(t,Ht),f=await c.decrypt({iv:r,name:Ht},v,i);return new Uint8Array(f)}async function $n(r,t){const i=de.getSubtleCrypto(),c=await He(r,Fe),v=await i.sign({length:qn,name:Fe},c,t);return new Uint8Array(v)}function Kn(r,t,i){return zn(r,t,i)}function Jn(r,t,i){return Vn(r,t,i)}async function Ar(r,t){return await $n(r,t)}async function Ir(r){const t=(r||256)/8,i=xn(t);return Wi(ve(i))}async function Er(r,t){const i=he(r.data),c=he(r.iv),v=he(r.hmac),f=ae(v,!1),N=vr(i,c),W=await Ar(t,N),C=ae(W,!1);return jt(f)===jt(C)}async function Gn(r,t,i){const c=ce(Ce(t)),v=i||await Ir(128),f=ce(Ce(v)),N=ae(f,!1),W=JSON.stringify(r),C=Bi(W),D=await Kn(f,c,C),Rt=ae(D,!1),H=vr(D,f),Ot=await Ar(c,H),At=ae(Ot,!1);return{data:Rt,hmac:At,iv:N}}async function Zn(r,t){const i=ce(Ce(t));if(!i)throw new Error("Missing key: required for decryption");if(!await Er(r,i))return null;const v=he(r.data),f=he(r.iv),N=await Jn(f,i,v),W=Ii(N);let C;try{C=JSON.parse(W)}catch{return null}return C}const Qn=Object.freeze(Object.defineProperty({__proto__:null,decrypt:Zn,encrypt:Gn,generateKey:Ir,verifyHmac:Er},Symbol.toStringTag,{value:"Module"}));class ss extends Fn{constructor(t,i){super({cryptoLib:Qn,connectorOpts:t,pushServerOpts:i})}}const Xn={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},Br={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},It={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Bt={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Dt={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class b{static getFirstMatch(t,i){const c=i.match(t);return c&&c.length>0&&c[1]||""}static getSecondMatch(t,i){const c=i.match(t);return c&&c.length>1&&c[2]||""}static matchAndReturnConst(t,i,c){if(t.test(i))return c}static getWindowsVersionName(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(t){const i=t.split(".").splice(0,2).map(c=>parseInt(c,10)||0);if(i.push(0),i[0]===10)switch(i[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(t){const i=t.split(".").splice(0,2).map(c=>parseInt(c,10)||0);if(i.push(0),!(i[0]===1&&i[1]<5)){if(i[0]===1&&i[1]<6)return"Cupcake";if(i[0]===1&&i[1]>=6)return"Donut";if(i[0]===2&&i[1]<2)return"Eclair";if(i[0]===2&&i[1]===2)return"Froyo";if(i[0]===2&&i[1]>2)return"Gingerbread";if(i[0]===3)return"Honeycomb";if(i[0]===4&&i[1]<1)return"Ice Cream Sandwich";if(i[0]===4&&i[1]<4)return"Jelly Bean";if(i[0]===4&&i[1]>=4)return"KitKat";if(i[0]===5)return"Lollipop";if(i[0]===6)return"Marshmallow";if(i[0]===7)return"Nougat";if(i[0]===8)return"Oreo";if(i[0]===9)return"Pie"}}static getVersionPrecision(t){return t.split(".").length}static compareVersions(t,i,c=!1){const v=b.getVersionPrecision(t),f=b.getVersionPrecision(i);let N=Math.max(v,f),W=0;const C=b.map([t,i],D=>{const Rt=N-b.getVersionPrecision(D),H=D+new Array(Rt+1).join(".0");return b.map(H.split("."),Ot=>new Array(20-Ot.length).join("0")+Ot).reverse()});for(c&&(W=N-Math.min(v,f)),N-=1;N>=W;){if(C[0][N]>C[1][N])return 1;if(C[0][N]===C[1][N]){if(N===W)return 0;N-=1}else if(C[0][N]<C[1][N])return-1}}static map(t,i){const c=[];let v;if(Array.prototype.map)return Array.prototype.map.call(t,i);for(v=0;v<t.length;v+=1)c.push(i(t[v]));return c}static find(t,i){let c,v;if(Array.prototype.find)return Array.prototype.find.call(t,i);for(c=0,v=t.length;c<v;c+=1){const f=t[c];if(i(f,c))return f}}static assign(t,...i){const c=t;let v,f;if(Object.assign)return Object.assign(t,...i);for(v=0,f=i.length;v<f;v+=1){const N=i[v];typeof N=="object"&&N!==null&&Object.keys(N).forEach(C=>{c[C]=N[C]})}return t}static getBrowserAlias(t){return Xn[t]}static getBrowserTypeByAlias(t){return Br[t]||""}}const j=/version\/(\d+(\.?_?\d+)+)/i,Yn=[{test:[/googlebot/i],describe(r){const t={name:"Googlebot"},i=b.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/opera/i],describe(r){const t={name:"Opera"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/opr\/|opios/i],describe(r){const t={name:"Opera"},i=b.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/SamsungBrowser/i],describe(r){const t={name:"Samsung Internet for Android"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/Whale/i],describe(r){const t={name:"NAVER Whale Browser"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/MZBrowser/i],describe(r){const t={name:"MZ Browser"},i=b.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/focus/i],describe(r){const t={name:"Focus"},i=b.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/swing/i],describe(r){const t={name:"Swing"},i=b.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/coast/i],describe(r){const t={name:"Opera Coast"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(r){const t={name:"Opera Touch"},i=b.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/yabrowser/i],describe(r){const t={name:"Yandex Browser"},i=b.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/ucbrowser/i],describe(r){const t={name:"UC Browser"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/Maxthon|mxios/i],describe(r){const t={name:"Maxthon"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/epiphany/i],describe(r){const t={name:"Epiphany"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/puffin/i],describe(r){const t={name:"Puffin"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/sleipnir/i],describe(r){const t={name:"Sleipnir"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/k-meleon/i],describe(r){const t={name:"K-Meleon"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/micromessenger/i],describe(r){const t={name:"WeChat"},i=b.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/qqbrowser/i],describe(r){const t={name:/qqbrowserlite/i.test(r)?"QQ Browser Lite":"QQ Browser"},i=b.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/msie|trident/i],describe(r){const t={name:"Internet Explorer"},i=b.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/\sedg\//i],describe(r){const t={name:"Microsoft Edge"},i=b.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/edg([ea]|ios)/i],describe(r){const t={name:"Microsoft Edge"},i=b.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/vivaldi/i],describe(r){const t={name:"Vivaldi"},i=b.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/seamonkey/i],describe(r){const t={name:"SeaMonkey"},i=b.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/sailfish/i],describe(r){const t={name:"Sailfish"},i=b.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,r);return i&&(t.version=i),t}},{test:[/silk/i],describe(r){const t={name:"Amazon Silk"},i=b.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/phantom/i],describe(r){const t={name:"PhantomJS"},i=b.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/slimerjs/i],describe(r){const t={name:"SlimerJS"},i=b.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(r){const t={name:"BlackBerry"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/(web|hpw)[o0]s/i],describe(r){const t={name:"WebOS Browser"},i=b.getFirstMatch(j,r)||b.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/bada/i],describe(r){const t={name:"Bada"},i=b.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/tizen/i],describe(r){const t={name:"Tizen"},i=b.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/qupzilla/i],describe(r){const t={name:"QupZilla"},i=b.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/firefox|iceweasel|fxios/i],describe(r){const t={name:"Firefox"},i=b.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/electron/i],describe(r){const t={name:"Electron"},i=b.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/MiuiBrowser/i],describe(r){const t={name:"Miui"},i=b.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/chromium/i],describe(r){const t={name:"Chromium"},i=b.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,r)||b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/chrome|crios|crmo/i],describe(r){const t={name:"Chrome"},i=b.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/GSA/i],describe(r){const t={name:"Google Search"},i=b.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test(r){const t=!r.test(/like android/i),i=r.test(/android/i);return t&&i},describe(r){const t={name:"Android Browser"},i=b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/playstation 4/i],describe(r){const t={name:"PlayStation 4"},i=b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/safari|applewebkit/i],describe(r){const t={name:"Safari"},i=b.getFirstMatch(j,r);return i&&(t.version=i),t}},{test:[/.*/i],describe(r){const t=/^(.*)\/(.*) /,i=/^(.*)\/(.*)[ \t]\((.*)/,v=r.search("\\(")!==-1?i:t;return{name:b.getFirstMatch(v,r),version:b.getSecondMatch(v,r)}}}],ts=[{test:[/Roku\/DVP/],describe(r){const t=b.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,r);return{name:Bt.Roku,version:t}}},{test:[/windows phone/i],describe(r){const t=b.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,r);return{name:Bt.WindowsPhone,version:t}}},{test:[/windows /i],describe(r){const t=b.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,r),i=b.getWindowsVersionName(t);return{name:Bt.Windows,version:t,versionName:i}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(r){const t={name:Bt.iOS},i=b.getSecondMatch(/(Version\/)(\d[\d.]+)/,r);return i&&(t.version=i),t}},{test:[/macintosh/i],describe(r){const t=b.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,r).replace(/[_\s]/g,"."),i=b.getMacOSVersionName(t),c={name:Bt.MacOS,version:t};return i&&(c.versionName=i),c}},{test:[/(ipod|iphone|ipad)/i],describe(r){const t=b.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,r).replace(/[_\s]/g,".");return{name:Bt.iOS,version:t}}},{test(r){const t=!r.test(/like android/i),i=r.test(/android/i);return t&&i},describe(r){const t=b.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,r),i=b.getAndroidVersionName(t),c={name:Bt.Android,version:t};return i&&(c.versionName=i),c}},{test:[/(web|hpw)[o0]s/i],describe(r){const t=b.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,r),i={name:Bt.WebOS};return t&&t.length&&(i.version=t),i}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(r){const t=b.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,r)||b.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,r)||b.getFirstMatch(/\bbb(\d+)/i,r);return{name:Bt.BlackBerry,version:t}}},{test:[/bada/i],describe(r){const t=b.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,r);return{name:Bt.Bada,version:t}}},{test:[/tizen/i],describe(r){const t=b.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,r);return{name:Bt.Tizen,version:t}}},{test:[/linux/i],describe(){return{name:Bt.Linux}}},{test:[/CrOS/],describe(){return{name:Bt.ChromeOS}}},{test:[/PlayStation 4/],describe(r){const t=b.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,r);return{name:Bt.PlayStation4,version:t}}}],es=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(r){const t=b.getFirstMatch(/(can-l01)/i,r)&&"Nova",i={type:It.mobile,vendor:"Huawei"};return t&&(i.model=t),i}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:It.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:It.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:It.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:It.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:It.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:It.tablet}}},{test(r){const t=r.test(/ipod|iphone/i),i=r.test(/like (ipod|iphone)/i);return t&&!i},describe(r){const t=b.getFirstMatch(/(ipod|iphone)/i,r);return{type:It.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:It.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:It.mobile}}},{test(r){return r.getBrowserName(!0)==="blackberry"},describe(){return{type:It.mobile,vendor:"BlackBerry"}}},{test(r){return r.getBrowserName(!0)==="bada"},describe(){return{type:It.mobile}}},{test(r){return r.getBrowserName()==="windows phone"},describe(){return{type:It.mobile,vendor:"Microsoft"}}},{test(r){const t=Number(String(r.getOSVersion()).split(".")[0]);return r.getOSName(!0)==="android"&&t>=3},describe(){return{type:It.tablet}}},{test(r){return r.getOSName(!0)==="android"},describe(){return{type:It.mobile}}},{test(r){return r.getOSName(!0)==="macos"},describe(){return{type:It.desktop,vendor:"Apple"}}},{test(r){return r.getOSName(!0)==="windows"},describe(){return{type:It.desktop}}},{test(r){return r.getOSName(!0)==="linux"},describe(){return{type:It.desktop}}},{test(r){return r.getOSName(!0)==="playstation 4"},describe(){return{type:It.tv}}},{test(r){return r.getOSName(!0)==="roku"},describe(){return{type:It.tv}}}],rs=[{test(r){return r.getBrowserName(!0)==="microsoft edge"},describe(r){if(/\sedg\//i.test(r))return{name:Dt.Blink};const i=b.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,r);return{name:Dt.EdgeHTML,version:i}}},{test:[/trident/i],describe(r){const t={name:Dt.Trident},i=b.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test(r){return r.test(/presto/i)},describe(r){const t={name:Dt.Presto},i=b.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test(r){const t=r.test(/gecko/i),i=r.test(/like gecko/i);return t&&!i},describe(r){const t={name:Dt.Gecko},i=b.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:Dt.Blink}}},{test:[/(apple)?webkit/i],describe(r){const t={name:Dt.WebKit},i=b.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,r);return i&&(t.version=i),t}}];class rr{constructor(t,i=!1){if(t==null||t==="")throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},i!==!0&&this.parse()}getUA(){return this._ua}test(t){return t.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const t=b.find(Yn,i=>{if(typeof i.test=="function")return i.test(this);if(i.test instanceof Array)return i.test.some(c=>this.test(c));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const t=b.find(ts,i=>{if(typeof i.test=="function")return i.test(this);if(i.test instanceof Array)return i.test.some(c=>this.test(c));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os}getOSName(t){const{name:i}=this.getOS();return t?String(i).toLowerCase()||"":i||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(t=!1){const{type:i}=this.getPlatform();return t?String(i).toLowerCase()||"":i||""}parsePlatform(){this.parsedResult.platform={};const t=b.find(es,i=>{if(typeof i.test=="function")return i.test(this);if(i.test instanceof Array)return i.test.some(c=>this.test(c));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const t=b.find(rs,i=>{if(typeof i.test=="function")return i.test(this);if(i.test instanceof Array)return i.test.some(c=>this.test(c));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return b.assign({},this.parsedResult)}satisfies(t){const i={};let c=0;const v={};let f=0;if(Object.keys(t).forEach(W=>{const C=t[W];typeof C=="string"?(v[W]=C,f+=1):typeof C=="object"&&(i[W]=C,c+=1)}),c>0){const W=Object.keys(i),C=b.find(W,Rt=>this.isOS(Rt));if(C){const Rt=this.satisfies(i[C]);if(Rt!==void 0)return Rt}const D=b.find(W,Rt=>this.isPlatform(Rt));if(D){const Rt=this.satisfies(i[D]);if(Rt!==void 0)return Rt}}if(f>0){const W=Object.keys(v),C=b.find(W,D=>this.isBrowser(D,!0));if(C!==void 0)return this.compareVersion(v[C])}}isBrowser(t,i=!1){const c=this.getBrowserName().toLowerCase();let v=t.toLowerCase();const f=b.getBrowserTypeByAlias(v);return i&&f&&(v=f.toLowerCase()),v===c}compareVersion(t){let i=[0],c=t,v=!1;const f=this.getBrowserVersion();if(typeof f=="string")return t[0]===">"||t[0]==="<"?(c=t.substr(1),t[1]==="="?(v=!0,c=t.substr(2)):i=[],t[0]===">"?i.push(1):i.push(-1)):t[0]==="="?c=t.substr(1):t[0]==="~"&&(v=!0,c=t.substr(1)),i.indexOf(b.compareVersions(f,c,v))>-1}isOS(t){return this.getOSName(!0)===String(t).toLowerCase()}isPlatform(t){return this.getPlatformType(!0)===String(t).toLowerCase()}isEngine(t){return this.getEngineName(!0)===String(t).toLowerCase()}is(t,i=!1){return this.isBrowser(t,i)||this.isOS(t)||this.isPlatform(t)}some(t=[]){return t.some(i=>this.is(i))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class os{static getParser(t,i=!1){if(typeof t!="string")throw new Error("UserAgent should be a string");return new rr(t,i)}static parse(t){return new rr(t).getResult()}static get BROWSER_MAP(){return Br}static get ENGINE_MAP(){return Dt}static get OS_MAP(){return Bt}static get PLATFORMS_MAP(){return It}}export{os as B,ss as W};
